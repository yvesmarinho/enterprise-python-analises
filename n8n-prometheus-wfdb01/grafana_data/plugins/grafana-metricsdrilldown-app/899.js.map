{"version":3,"file":"899.js?_cache=651647977333f8d3b018","mappings":"2SAaA,MAAMA,GAAaC,EAAAA,EAAAA,4BAA2B,aAAc,CAC1DC,QAAQ,EACRC,MAAO,6BACPC,KAAM,CACJC,KAAM,oBACNC,YAAa,+DACbC,SAAU,CACRC,OAAQ,mDACRC,QAAS,CACPC,aAAc,0DACdC,cAAe,8CACfC,cAAe,8CACfC,QAAS,sEAEXC,QAAS,0EACTC,UAAW,oEACXC,eAAgB,sDAChBC,YAAa,gDACbC,QAAS,2DAEXC,WAAY,CACVC,YAAa,wCACbC,aAAc,mDACdC,KAAM,CAAC,YAAa,kBAAmB,oBAShCC,EAAwC,CACnD,CACEC,OAAQ,6CACRC,QAAS,CAACzB,IAEZ,CACEwB,OAAQ,mCACRC,QAAS,CAACzB,IAEZ,CACEwB,OAAQ,wDACRC,QAAS,CAACzB,KCjCP,SAAS0B,EACdC,EACAC,EACAC,GAEA,GAAID,GAAUD,aAAoBG,EAAAA,EAAa,CAO7C,MAAMC,EAAe,IAAIC,gBAAgBC,OAAOC,SAAS1B,QACnD2B,EAAoC,IAAIH,gBAAgBD,GAC9DI,EAAkCC,IAAI,aAAcC,EAAAA,IAgBpD,MAdmC,CACjCC,KAAMT,EACNU,IAAK,GAAGN,OAAOC,SAASM,YAAYT,EAAaU,aACjDC,WAAY,CACVJ,KAAMV,EAENW,IAAK,GAAGN,OAAOC,SAASM,YAAYL,EAAkCM,aACtEC,WAAY,CACVJ,MAAMK,EAAAA,EAAAA,GAAE,2BAA4B,WACpCJ,IAAKN,OAAOC,SAASM,WAM7B,CAAO,GAAIb,aAAoBiB,EAAAA,EAC7B,MAAO,CAAEN,MAAMK,EAAAA,EAAAA,GAAE,+BAAgC,eAIrD,CAEe,SAASE,GAAM,MAAEC,KC5C9BC,EAAAA,EAAAA,qBAAoB,6CAA8CxB,GDiDlE,MAAM,SAAEI,EAAQ,OAAEC,GAAWkB,EAAME,YAC5BnB,EAAuBoB,IAA4BD,EAAAA,EAAAA,UAAiB,KAG3EE,EAAAA,EAAAA,WAAU,KACR,KAAMvB,aAAoBG,EAAAA,GAExB,YADAmB,EAAyB,IAK3BA,EAAyBtB,EAASwB,qBAGlC,MAAMC,EAAuBzB,EAAS0B,iBAAiB,KACrDJ,EAAyBtB,EAASwB,uBAGpC,MAAO,KACDC,GACFA,EAAqBE,gBAGxB,CAAC3B,IAGJ,MAAM4B,GAAUC,EAAAA,EAAAA,SACd,IAAgC9B,EAAWC,EAAUC,EAAQC,GAC7D,CAACF,EAAUC,EAAQC,IAGrB,OACE,kBAAC4B,EAAAA,WAAUA,CAACF,QAASA,EAASG,OAAQC,EAAAA,eAAeC,QACnD,kBAACC,EAAAA,uBAAsBA,CACrBC,MAAOhB,EACPiB,2BAA2B,EAC3BC,iBAAiB,EACjBC,UAAWnB,EAAMoB,MAAMC,cAEvB,kBAACrB,EAAMsB,UAAS,CAACC,MAAOvB,KAIhC,C","sources":["webpack://grafana-metricsdrilldown-app/./App/assistant/questions.ts","webpack://grafana-metricsdrilldown-app/./App/Trail.tsx","webpack://grafana-metricsdrilldown-app/./App/assistant/useMetricsDrilldownQuestions.ts"],"sourcesContent":["/**\n * Assistant Questions for Grafana Metrics Drilldown app\n *\n * This file contains all questions that appear in Grafana Assistant for this app.\n * Questions provide quick-start guidance with contextual information about app features.\n *\n * URL Pattern: /a/grafana-metricsdrilldown-app/drilldown*\n * These questions appear anywhere in the Metrics Drilldown app.\n */\n\nimport { createAssistantContextItem, type Question } from '@grafana/assistant';\n\n// App context that provides information about Metrics Drilldown features\nconst appContext = createAssistantContextItem('structured', {\n  hidden: true,\n  title: 'Metrics Drilldown Features',\n  data: {\n    name: 'Metrics Drilldown',\n    description: 'Queryless exploration tool for Prometheus-compatible metrics',\n    features: {\n      search: 'Search metrics by name in the Quick Search input',\n      filters: {\n        labelFilters: 'Apply label name and value filters in the Filters input',\n        prefixFilters: 'Filter by metric name prefix in the sidebar',\n        suffixFilters: 'Filter by metric name suffix in the sidebar',\n        groupBy: 'Group metrics by label using the Group by labels filter in sidebar',\n      },\n      sorting: 'Sort by alphabetical, recently used, dashboard usage, or alerting rules',\n      breakdown: 'View metric labels in the Breakdown tab when a metric is selected',\n      relatedMetrics: 'Discover related metrics in the Related Metrics tab',\n      relatedLogs: 'Discover related logs in the Related Logs tab',\n      sharing: 'Use Copy URL button in panel menu to share metric views',\n    },\n    navigation: {\n      metricsList: 'Main view shows all available metrics',\n      metricDetail: 'Selecting a metric opens detailed view with tabs',\n      tabs: ['Breakdown', 'Related Metrics', 'Related Logs'],\n    },\n  },\n});\n\n// ============================================================================\n// METRICS DRILLDOWN - Getting Started Questions\n// URL Pattern: /a/grafana-metricsdrilldown-app/drilldown* (all app pages)\n// ============================================================================\nexport const metricsDrilldownQuestions: Question[] = [\n  {\n    prompt: 'How can I find a metric I\\'m interested in?',\n    context: [appContext],\n  },\n  {\n    prompt: 'How can I see a metric\\'s labels?',\n    context: [appContext],\n  },\n  {\n    prompt: 'When I find a metric of interest, what can I do next?',\n    context: [appContext],\n  },\n];\n","import { PageLayoutType, type NavModelItem } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { PluginPage } from '@grafana/runtime';\nimport { UrlSyncContextProvider, type SceneObject } from '@grafana/scenes';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nimport { type DataTrail } from '../AppDataTrail/DataTrail';\nimport { defaultActionView } from '../MetricScene/MetricActionBar';\nimport { MetricScene } from '../MetricScene/MetricScene';\nimport { MetricsReducer } from '../MetricsReducer/MetricsReducer';\nimport { useMetricsDrilldownQuestions } from './assistant/useMetricsDrilldownQuestions';\n\ninterface TrailProps {\n  trail: DataTrail;\n}\n\n/**\n * Generates the page navigation breadcrumb based on the current scene state\n * @param topScene - The current top-level scene (MetricScene or MetricsReducer)\n * @param metric - The currently selected metric name\n * @param currentActionViewName - The display name of the current action view\n * @returns Navigation model item for breadcrumbs, or undefined if no navigation should be shown\n */\nexport function getPageNav(\n  topScene: SceneObject | undefined,\n  metric: string | undefined,\n  currentActionViewName: string\n): NavModelItem | undefined {\n  if (metric && topScene instanceof MetricScene) {\n    // When a metric is selected, we add the metric name and action view name to the navigation breadcrumbs\n    // For example:\n    // - \"Home > Drilldown > Metrics > some_metric > Breakdown\"\n    // - \"Home > Drilldown > Metrics > some_metric > Related metrics\"\n    // - \"Home > Drilldown > Metrics > some_metric > Related logs\"\n\n    const searchParams = new URLSearchParams(window.location.search);\n    const searchParamsWithDefaultActionView = new URLSearchParams(searchParams);\n    searchParamsWithDefaultActionView.set('actionView', defaultActionView);\n\n    const navModelItem: NavModelItem = {\n      text: currentActionViewName,\n      url: `${window.location.pathname}?${searchParams.toString()}`,\n      parentItem: {\n        text: metric,\n        // Clicking on the metric name should reset the default action view\n        url: `${window.location.pathname}?${searchParamsWithDefaultActionView.toString()}`,\n        parentItem: {\n          text: t('trail.breadcrumb.metrics', 'Metrics'),\n          url: window.location.pathname,\n        },\n      },\n    };\n\n    return navModelItem;\n  } else if (topScene instanceof MetricsReducer) {\n    return { text: t('trail.breadcrumb.all-metrics', 'All metrics') };\n  }\n\n  return undefined;\n}\n\nexport default function Trail({ trail }: Readonly<TrailProps>) {\n  // Register all assistant questions for metrics drilldown\n  // Questions are automatically matched based on URL patterns\n  useMetricsDrilldownQuestions();\n\n  const { topScene, metric } = trail.useState();\n  const [currentActionViewName, setCurrentActionViewName] = useState<string>('');\n\n  // Subscribe to MetricScene state changes to update breadcrumb\n  useEffect(() => {\n    if (!(topScene instanceof MetricScene)) {\n      setCurrentActionViewName('');\n      return undefined;\n    }\n\n    // Get current action view name\n    setCurrentActionViewName(topScene.getActionViewName());\n\n    // Subscribe to action view state changes\n    const topSceneSubscription = topScene.subscribeToState(() => {\n      setCurrentActionViewName(topScene.getActionViewName());\n    });\n\n    return () => {\n      if (topSceneSubscription) {\n        topSceneSubscription.unsubscribe();\n      }\n    };\n  }, [topScene]);\n\n  // Create pageNav based on current state\n  const pageNav = useMemo(\n    (): NavModelItem | undefined => getPageNav(topScene, metric, currentActionViewName),\n    [topScene, metric, currentActionViewName]\n  );\n\n  return (\n    <PluginPage pageNav={pageNav} layout={PageLayoutType.Custom}>\n      <UrlSyncContextProvider\n        scene={trail}\n        createBrowserHistorySteps={true}\n        updateUrlOnInit={true}\n        namespace={trail.state.urlNamespace}\n      >\n        <trail.Component model={trail} />\n      </UrlSyncContextProvider>\n    </PluginPage>\n  );\n}\n","/**\n * Hook to register all assistant questions for Metrics Drilldown app\n *\n * This hook should be called once at the app root level (Trail component).\n * It registers different question sets for different URL patterns.\n *\n * The Grafana Assistant will automatically show relevant questions based on\n * the current URL matching the patterns defined here.\n */\n\nimport { useProvideQuestions } from '@grafana/assistant';\n\nimport { metricsDrilldownQuestions } from './questions';\n\nexport function useMetricsDrilldownQuestions() {\n  // Register questions for the entire Metrics Drilldown app\n  // Matches any URL in the metrics drilldown app\n  useProvideQuestions('/a/grafana-metricsdrilldown-app/drilldown*', metricsDrilldownQuestions);\n}\n"],"names":["appContext","createAssistantContextItem","hidden","title","data","name","description","features","search","filters","labelFilters","prefixFilters","suffixFilters","groupBy","sorting","breakdown","relatedMetrics","relatedLogs","sharing","navigation","metricsList","metricDetail","tabs","metricsDrilldownQuestions","prompt","context","getPageNav","topScene","metric","currentActionViewName","MetricScene","searchParams","URLSearchParams","window","location","searchParamsWithDefaultActionView","set","defaultActionView","text","url","pathname","toString","parentItem","t","MetricsReducer","Trail","trail","useProvideQuestions","useState","setCurrentActionViewName","useEffect","getActionViewName","topSceneSubscription","subscribeToState","unsubscribe","pageNav","useMemo","PluginPage","layout","PageLayoutType","Custom","UrlSyncContextProvider","scene","createBrowserHistorySteps","updateUrlOnInit","namespace","state","urlNamespace","Component","model"],"sourceRoot":""}