{"version":3,"file":"909.js?_cache=4726e3110ce00b46080c","mappings":"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","sources":["webpack://grafana-lokiexplore-app/../node_modules/@openfeature/ofrep-core/index.esm.js","webpack://grafana-lokiexplore-app/../node_modules/@openfeature/ofrep-web-provider/index.esm.js","webpack://grafana-lokiexplore-app/../node_modules/@openfeature/core/dist/esm/index.js","webpack://grafana-lokiexplore-app/../node_modules/@openfeature/web-sdk/dist/esm/index.js"],"sourcesContent":["import { ErrorCode, StandardResolutionReasons } from '@openfeature/core';\n\nclass OFREPApiError extends Error {\n    constructor(error, response, message, options) {\n        super(message, options);\n        this.error = error;\n        this.response = response;\n        Object.setPrototypeOf(this, OFREPApiError.prototype);\n        this.name = OFREPApiError.name;\n    }\n}\nclass OFREPApiFetchError extends OFREPApiError {\n    constructor(error, message, options) {\n        super(error, undefined, message, options);\n        Object.setPrototypeOf(this, OFREPApiFetchError.prototype);\n        this.name = OFREPApiFetchError.name;\n    }\n}\nclass OFREPApiUnexpectedResponseError extends OFREPApiError {\n    constructor(response, message, options) {\n        super(undefined, response, message, options);\n        Object.setPrototypeOf(this, OFREPApiUnexpectedResponseError.prototype);\n        this.name = OFREPApiUnexpectedResponseError.name;\n    }\n}\nclass OFREPApiUnauthorizedError extends OFREPApiError {\n    constructor(response, message, options) {\n        super(undefined, response, message, options);\n        Object.setPrototypeOf(this, OFREPApiUnauthorizedError.prototype);\n        this.name = OFREPApiUnauthorizedError.name;\n        this.message = message !== null && message !== void 0 ? message : 'OFREP request failed: unauthorized';\n    }\n}\nclass OFREPForbiddenError extends OFREPApiError {\n    constructor(response, message, options) {\n        super(undefined, response, message, options);\n        Object.setPrototypeOf(this, OFREPForbiddenError.prototype);\n        this.name = OFREPForbiddenError.name;\n        this.message = message !== null && message !== void 0 ? message : 'OFREP request failed: forbidden';\n    }\n}\nclass OFREPApiTooManyRequestsError extends OFREPApiError {\n    constructor(response, message, options) {\n        super(undefined, response, message, options);\n        this.response = response;\n        Object.setPrototypeOf(this, OFREPApiTooManyRequestsError.prototype);\n        this.name = OFREPApiTooManyRequestsError.name;\n        this.requestTime = new Date();\n        this.message =\n            (message !== null && message !== void 0 ? message : this.retryAfterDate)\n                ? `rate limit exceeded, try again after ${this.retryAfterDate}`\n                : `rate limit exceeded, try again later`;\n    }\n    get retryAfterHeader() {\n        return this.response.headers.get('Retry-After');\n    }\n    get retryAfterSeconds() {\n        if (!this.retryAfterHeader) {\n            return null;\n        }\n        const retrySeconds = Number.parseInt(this.retryAfterHeader, 10);\n        if (!Number.isFinite(retrySeconds)) {\n            return null;\n        }\n        return retrySeconds;\n    }\n    get retryAfterDate() {\n        if (!this.retryAfterHeader) {\n            return null;\n        }\n        if (this.retryAfterSeconds) {\n            const retryAfterSeconds = this.retryAfterSeconds;\n            if (!retryAfterSeconds) {\n                return null;\n            }\n            return new Date(this.requestTime.getTime() + this.retryAfterSeconds * 1000);\n        }\n        const date = new Date(this.retryAfterHeader);\n        if (isNaN(date.valueOf())) {\n            return null;\n        }\n        return date;\n    }\n}\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nfunction isEvaluationFailureResponse(response) {\n    if (!response || typeof response !== 'object') {\n        return false;\n    }\n    return ('key' in response &&\n        typeof response.key === 'string' &&\n        'errorCode' in response &&\n        typeof response.errorCode === 'string');\n}\n\nfunction isBulkEvaluationFailureResponse(response) {\n    if (!response || typeof response !== 'object') {\n        return false;\n    }\n    return 'errorCode' in response;\n}\nfunction isBulkEvaluationSuccessResponse(response) {\n    if (!response || typeof response !== 'object') {\n        return false;\n    }\n    return 'flags' in response;\n}\n\nconst OFREPEvaluationErrorHttpStatuses = [400, 404, 500];\nconst OFREPEvaluationSuccessHttpStatuses = [200];\n\n/**\n * Builds headers from static and factory, as well as default content type\n * @param options options\n * @returns built headers\n */\nfunction buildHeaders(options_1) {\n    return __awaiter(this, arguments, void 0, function* (options, etag = null) {\n        var _a;\n        return new Headers([\n            ['Content-Type', 'application/json; charset=utf-8'],\n            ...((options === null || options === void 0 ? void 0 : options.headers) || []),\n            ...((yield ((_a = options === null || options === void 0 ? void 0 : options.headersFactory) === null || _a === void 0 ? void 0 : _a.call(options))) || []),\n            ...(etag ? [['If-None-Match', etag]] : []),\n        ]);\n    });\n}\n\n/**\n * Checks whether the parameter is not undefined.\n * @param {unknown} value The value to check\n * @returns {value is string} True if the value is a string\n */\nfunction isDefined(value) {\n    return typeof value !== 'undefined';\n}\n\nfunction isomorphicFetch() {\n    // We need to do this, as fetch needs the window as scope in the browser: https://fetch.spec.whatwg.org/#concept-request-window\n    // Without this any request will fail in the browser https://stackoverflow.com/questions/69876859/why-does-bind-fix-failed-to-execute-fetch-on-window-illegal-invocation-err\n    if (globalThis) {\n        return globalThis.fetch.bind(globalThis);\n    }\n    else if (window) {\n        return window.fetch.bind(window);\n    }\n    else if (self) {\n        self.fetch.bind(self);\n    }\n    return fetch;\n}\nconst DEFAULT_TIMEOUT_MS = 10000;\nconst ErrorMessageMap = {\n    [ErrorCode.FLAG_NOT_FOUND]: 'Flag was not found',\n    [ErrorCode.GENERAL]: 'General error',\n    [ErrorCode.INVALID_CONTEXT]: 'Context is invalid or could be parsed',\n    [ErrorCode.PARSE_ERROR]: 'Flag or flag configuration could not be parsed',\n    [ErrorCode.PROVIDER_FATAL]: 'Provider is in a fatal error state',\n    [ErrorCode.PROVIDER_NOT_READY]: 'Provider is not yet ready',\n    [ErrorCode.TARGETING_KEY_MISSING]: 'Targeting key is missing',\n    [ErrorCode.TYPE_MISMATCH]: 'Flag is not of expected type',\n};\nclass OFREPApi {\n    constructor(baseOptions, fetchImplementation = isomorphicFetch()) {\n        this.baseOptions = baseOptions;\n        this.fetchImplementation = fetchImplementation;\n    }\n    isJsonMime(response) {\n        const contentTypeHeader = response.headers.get('Content-Type');\n        return !!contentTypeHeader && OFREPApi.jsonRegex.test(contentTypeHeader);\n    }\n    static isOFREFErrorHttpStatus(status) {\n        return OFREPEvaluationErrorHttpStatuses.includes(status);\n    }\n    static isOFREFSuccessHttpStatus(status) {\n        return OFREPEvaluationSuccessHttpStatuses.includes(status);\n    }\n    doFetchRequest(req) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            let response;\n            try {\n                const timeoutMs = (_a = this.baseOptions.timeoutMs) !== null && _a !== void 0 ? _a : DEFAULT_TIMEOUT_MS;\n                const controller = new AbortController();\n                // Uses a setTimeout instead of AbortSignal.timeout to support older runtimes.\n                setTimeout(() => controller.abort(new DOMException(`This signal is timeout in ${timeoutMs}ms`, 'TimeoutError')), timeoutMs);\n                response = yield this.fetchImplementation(req, {\n                    signal: controller.signal,\n                });\n            }\n            catch (err) {\n                throw new OFREPApiFetchError(err, 'The OFREP request failed.', { cause: err });\n            }\n            if (response.status === 401) {\n                throw new OFREPApiUnauthorizedError(response);\n            }\n            if (response.status === 403) {\n                throw new OFREPForbiddenError(response);\n            }\n            if (response.status === 429) {\n                throw new OFREPApiTooManyRequestsError(response);\n            }\n            if (response.status === 200 && !this.isJsonMime(response)) {\n                throw new OFREPApiUnexpectedResponseError(response, 'OFREP did not respond with expected MIME application/json');\n            }\n            try {\n                return { response, body: yield response.json() };\n            }\n            catch (_b) {\n                return { response };\n            }\n        });\n    }\n    postEvaluateFlag(flagKey, evaluationRequest) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let url = `${this.baseOptions.baseUrl}/ofrep/v1/evaluate/flags/${flagKey}`;\n            if (this.baseOptions.query) {\n                url = url + `?${this.baseOptions.query.toString()}`;\n            }\n            const request = new Request(url, {\n                headers: yield buildHeaders(this.baseOptions),\n                method: 'POST',\n                body: JSON.stringify(evaluationRequest !== null && evaluationRequest !== void 0 ? evaluationRequest : {}),\n            });\n            const { response, body } = yield this.doFetchRequest(request);\n            if (response.status === 200 && body && !isEvaluationFailureResponse(body)) {\n                return { httpStatus: response.status, value: body, httpResponse: response };\n            }\n            else if (OFREPApi.isOFREFErrorHttpStatus(response.status) && isEvaluationFailureResponse(body)) {\n                return { httpStatus: response.status, value: body, httpResponse: response };\n            }\n            throw new OFREPApiUnexpectedResponseError(response, 'The OFREP response does not match the expected format');\n        });\n    }\n    postBulkEvaluateFlags(requestBody_1) {\n        return __awaiter(this, arguments, void 0, function* (requestBody, etag = null) {\n            let url = `${this.baseOptions.baseUrl}/ofrep/v1/evaluate/flags`;\n            if (this.baseOptions.query) {\n                url = url + `?${this.baseOptions.query.toString()}`;\n            }\n            const request = new Request(url, {\n                headers: yield buildHeaders(this.baseOptions, etag),\n                method: 'POST',\n                body: JSON.stringify(requestBody !== null && requestBody !== void 0 ? requestBody : {}),\n            });\n            const { response, body } = yield this.doFetchRequest(request);\n            if (response.status === 200 && isBulkEvaluationSuccessResponse(body)) {\n                return { httpStatus: response.status, value: body, httpResponse: response };\n            }\n            else if (response.status === 304) {\n                return { httpStatus: response.status, value: undefined, httpResponse: response };\n            }\n            else if (OFREPApi.isOFREFErrorHttpStatus(response.status) && isBulkEvaluationFailureResponse(body)) {\n                return { httpStatus: response.status, value: body, httpResponse: response };\n            }\n            throw new OFREPApiUnexpectedResponseError(response, 'The OFREP response does not match the expected format');\n        });\n    }\n}\nOFREPApi.jsonRegex = new RegExp(/application\\/[^+]*[+]?(json);?.*/, 'i');\nfunction handleEvaluationError(resultOrError, defaultValue, callback) {\n    var _a, _b, _c;\n    callback === null || callback === void 0 ? void 0 : callback(resultOrError);\n    if ('errorCode' in resultOrError) {\n        const code = (_a = resultOrError.errorCode) !== null && _a !== void 0 ? _a : ErrorCode.GENERAL;\n        const message = (_c = (_b = resultOrError.errorDetails) !== null && _b !== void 0 ? _b : ErrorMessageMap[resultOrError.errorCode]) !== null && _c !== void 0 ? _c : resultOrError.errorCode;\n        const metadata = toFlagMetadata(resultOrError.metadata);\n        return {\n            value: defaultValue,\n            reason: StandardResolutionReasons.ERROR,\n            flagMetadata: metadata,\n            errorCode: code,\n            errorMessage: message,\n        };\n    }\n    else {\n        throw resultOrError;\n    }\n}\nfunction toResolutionDetails(result, defaultValue) {\n    if (!isDefined(result.value)) {\n        return {\n            value: defaultValue,\n            variant: result.variant,\n            flagMetadata: result.metadata,\n            reason: result.reason || StandardResolutionReasons.DEFAULT,\n        };\n    }\n    if (typeof result.value !== typeof defaultValue) {\n        return {\n            value: defaultValue,\n            reason: StandardResolutionReasons.ERROR,\n            flagMetadata: result.metadata,\n            errorCode: ErrorCode.TYPE_MISMATCH,\n            errorMessage: ErrorMessageMap[ErrorCode.TYPE_MISMATCH],\n        };\n    }\n    return {\n        value: result.value,\n        variant: result.variant,\n        reason: result.reason,\n        flagMetadata: toFlagMetadata(result.metadata),\n    };\n}\nfunction toFlagMetadata(metadata) {\n    if (!metadata) {\n        return undefined;\n    }\n    // OFREP metadata is defined as any object but OF metadata is defined as Record<string, string | number | boolean>\n    const originalEntries = Object.entries(metadata);\n    const onlyPrimitiveEntries = originalEntries.filter(([, value]) => ['string', 'number', 'boolean'].includes(typeof value));\n    return Object.fromEntries(onlyPrimitiveEntries);\n}\n\nexport { ErrorMessageMap, OFREPApi, OFREPApiFetchError, OFREPApiTooManyRequestsError, OFREPApiUnauthorizedError, OFREPApiUnexpectedResponseError, OFREPEvaluationErrorHttpStatuses, OFREPEvaluationSuccessHttpStatuses, OFREPForbiddenError, buildHeaders, handleEvaluationError, isBulkEvaluationFailureResponse, isBulkEvaluationSuccessResponse, isDefined, isEvaluationFailureResponse, toFlagMetadata, toResolutionDetails };\n","import { OFREPApi, ErrorMessageMap, isEvaluationFailureResponse, handleEvaluationError, toResolutionDetails, OFREPApiUnauthorizedError, OFREPForbiddenError, OFREPApiTooManyRequestsError, OFREPApiFetchError, toFlagMetadata } from '@openfeature/ofrep-core';\nimport { OpenFeatureEventEmitter, ErrorCode, StandardResolutionReasons, ProviderFatalError, ClientProviderEvents, OpenFeatureError, GeneralError } from '@openfeature/web-sdk';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nvar BulkEvaluationStatus;\n(function (BulkEvaluationStatus) {\n    BulkEvaluationStatus[\"SUCCESS_NO_CHANGES\"] = \"SUCCESS_NO_CHANGES\";\n    BulkEvaluationStatus[\"SUCCESS_WITH_CHANGES\"] = \"SUCCESS_WITH_CHANGES\";\n})(BulkEvaluationStatus || (BulkEvaluationStatus = {}));\n\nclass OFREPWebProvider {\n    constructor(options, logger) {\n        var _a;\n        this.DEFAULT_POLL_INTERVAL = 30000;\n        this.metadata = {\n            name: 'OpenFeature Remote Evaluation Protocol Web Provider',\n        };\n        this.runsOn = 'client';\n        this.events = new OpenFeatureEventEmitter();\n        this._flagCache = {};\n        this._options = options;\n        this._logger = logger;\n        this._etag = null;\n        this._ofrepAPI = new OFREPApi(this._options, this._options.fetchImplementation);\n        this._pollingInterval = (_a = this._options.pollInterval) !== null && _a !== void 0 ? _a : this.DEFAULT_POLL_INTERVAL;\n    }\n    /**\n     * Returns a shallow copy of the flag cache, which is updated at initialization/context-change/configuration-change once the flags are re-evaluated.\n     */\n    get flagCache() {\n        return Object.assign({}, this._flagCache);\n    }\n    /**\n     * Initialize the provider, it will evaluate the flags and start the polling if it is not disabled.\n     * @param context - the context to use for the evaluation\n     */\n    initialize(context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            try {\n                this._context = context;\n                yield this._fetchFlags(context);\n                if (this._pollingInterval > 0) {\n                    this.startPolling();\n                }\n                (_a = this._logger) === null || _a === void 0 ? void 0 : _a.debug(`${this.metadata.name} initialized successfully`);\n            }\n            catch (error) {\n                if (error instanceof OFREPApiUnauthorizedError || error instanceof OFREPForbiddenError) {\n                    throw new ProviderFatalError('Initialization failed', { cause: error });\n                }\n                throw error;\n            }\n        });\n    }\n    /* eslint-disable @typescript-eslint/no-unused-vars*/\n    /* to make overrides easier we keep these unused vars */\n    resolveBooleanEvaluation(flagKey, defaultValue, context) {\n        return this._resolve(flagKey, defaultValue);\n    }\n    resolveStringEvaluation(flagKey, defaultValue, context) {\n        return this._resolve(flagKey, defaultValue);\n    }\n    resolveNumberEvaluation(flagKey, defaultValue, context) {\n        return this._resolve(flagKey, defaultValue);\n    }\n    resolveObjectEvaluation(flagKey, defaultValue, context) {\n        return this._resolve(flagKey, defaultValue);\n    }\n    /**\n     * onContextChange is called when the context changes, it will re-evaluate the flags with the new context\n     * and update the cache.\n     * @param oldContext - the old evaluation context\n     * @param newContext - the new evaluation context\n     */\n    onContextChange(oldContext, newContext) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c;\n            try {\n                this._context = newContext;\n                const now = new Date();\n                if (this._retryPollingAfter !== undefined && this._retryPollingAfter > now) {\n                    // we do nothing because we should not call the endpoint\n                    return;\n                }\n                yield this._fetchFlags(newContext);\n            }\n            catch (error) {\n                if (error instanceof OFREPApiTooManyRequestsError) {\n                    (_a = this.events) === null || _a === void 0 ? void 0 : _a.emit(ClientProviderEvents.Stale, { message: `${error.name}: ${error.message}` });\n                    return;\n                }\n                if (error instanceof OpenFeatureError ||\n                    error instanceof OFREPApiFetchError ||\n                    error instanceof OFREPApiUnauthorizedError ||\n                    error instanceof OFREPForbiddenError) {\n                    (_b = this.events) === null || _b === void 0 ? void 0 : _b.emit(ClientProviderEvents.Error, { message: `${error.name}: ${error.message}` });\n                    return;\n                }\n                (_c = this.events) === null || _c === void 0 ? void 0 : _c.emit(ClientProviderEvents.Error, { message: `Unknown error: ${error}` });\n            }\n        });\n    }\n    /**\n     * onClose is called when the provider is closed, it will stop the polling if it is enabled.\n     */\n    onClose() {\n        this.stopPolling();\n        return Promise.resolve();\n    }\n    /**\n     * _fetchFlags is a function that will call the bulk evaluate flags endpoint to get the flags values.\n     * @param context - the context to use for the evaluation\n     * @private\n     * @returns EvaluationStatus if the evaluation the API returned a 304, 200.\n     * @throws TargetingKeyMissingError if the API returned a 400 with the error code TargetingKeyMissing\n     * @throws InvalidContextError if the API returned a 400 with the error code InvalidContext\n     * @throws ParseError if the API returned a 400 with the error code ParseError\n     * @throws GeneralError if the API returned a 400 with an unknown error code\n     */\n    _fetchFlags(context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            try {\n                const evalReq = {\n                    context,\n                };\n                const response = yield this._ofrepAPI.postBulkEvaluateFlags(evalReq, this._etag);\n                if (response.httpStatus === 304) {\n                    // nothing has changed since last time, we are doing nothing\n                    return { status: BulkEvaluationStatus.SUCCESS_NO_CHANGES, flags: [] };\n                }\n                if (response.httpStatus !== 200) {\n                    throw new GeneralError(`Failed OFREP bulk evaluation request, status: ${response.httpStatus}`);\n                }\n                const bulkSuccessResp = response.value;\n                if (!('flags' in bulkSuccessResp) || !Array.isArray(bulkSuccessResp.flags)) {\n                    throw new Error('No flags in OFREP bulk evaluation response');\n                }\n                const newCache = bulkSuccessResp.flags.reduce((currentCache, currentResponse) => {\n                    if (currentResponse.key) {\n                        currentCache[currentResponse.key] = currentResponse;\n                    }\n                    return currentCache;\n                }, {});\n                const listUpdatedFlags = this._getListUpdatedFlags(this._flagCache, newCache);\n                this._flagCache = newCache;\n                this._etag = (_a = response.httpResponse) === null || _a === void 0 ? void 0 : _a.headers.get('etag');\n                this._flagSetMetadataCache = toFlagMetadata(typeof bulkSuccessResp.metadata === 'object' ? bulkSuccessResp.metadata : {});\n                return { status: BulkEvaluationStatus.SUCCESS_WITH_CHANGES, flags: listUpdatedFlags };\n            }\n            catch (error) {\n                if (error instanceof OFREPApiTooManyRequestsError && error.retryAfterDate !== null) {\n                    this._retryPollingAfter = error.retryAfterDate;\n                }\n                throw error;\n            }\n        });\n    }\n    /**\n     * _getListUpdatedFlags is a function that will compare the old cache with the new cache and\n     * return the list of flags that have been updated / deleted / created.\n     * @param oldCache\n     * @param newCache\n     * @private\n     */\n    _getListUpdatedFlags(oldCache, newCache) {\n        const changedKeys = [];\n        const oldKeys = Object.keys(oldCache);\n        const newKeys = Object.keys(newCache);\n        // Check for added or modified keys in newCache\n        for (const key in newCache) {\n            if (oldKeys.indexOf(key) === -1 || JSON.stringify(oldCache[key]) !== JSON.stringify(newCache[key])) {\n                changedKeys.push(key);\n            }\n        }\n        // Check for removed keys in oldCache\n        for (const key in oldCache) {\n            if (newKeys.indexOf(key) === -1) {\n                changedKeys.push(key);\n            }\n        }\n        return changedKeys;\n    }\n    /**\n     * _resolve is a function retrieving the value from a flag in the cache.\n     * @param flagKey - name of the flag to retrieve\n     * @param type - type of the flag\n     * @param defaultValue - default value\n     * @private\n     */\n    _resolve(flagKey, defaultValue) {\n        const resolved = this._flagCache[flagKey];\n        if (!resolved) {\n            return {\n                value: defaultValue,\n                flagMetadata: this._flagSetMetadataCache,\n                reason: StandardResolutionReasons.ERROR,\n                errorCode: ErrorCode.FLAG_NOT_FOUND,\n                errorMessage: ErrorMessageMap[ErrorCode.FLAG_NOT_FOUND],\n            };\n        }\n        return this.responseToResolutionDetails(resolved, defaultValue);\n    }\n    responseToResolutionDetails(response, defaultValue) {\n        if (isEvaluationFailureResponse(response)) {\n            return handleEvaluationError(response, defaultValue);\n        }\n        return toResolutionDetails(response, defaultValue);\n    }\n    /**\n     * Start polling for flag updates, it will call the bulk update function every pollInterval\n     * @private\n     */\n    startPolling() {\n        this._pollingIntervalId = setInterval(() => __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            try {\n                const now = new Date();\n                if (this._retryPollingAfter !== undefined && this._retryPollingAfter > now) {\n                    return;\n                }\n                const res = yield this._fetchFlags(this._context);\n                if (res.status === BulkEvaluationStatus.SUCCESS_WITH_CHANGES) {\n                    (_a = this.events) === null || _a === void 0 ? void 0 : _a.emit(ClientProviderEvents.ConfigurationChanged, {\n                        message: 'Flags updated',\n                        flagsChanged: res.flags,\n                    });\n                }\n            }\n            catch (error) {\n                (_b = this.events) === null || _b === void 0 ? void 0 : _b.emit(ClientProviderEvents.Stale, { message: `Error while polling: ${error}` });\n            }\n        }), this._pollingInterval);\n    }\n    /**\n     * Stop polling for flag updates\n     * @private\n     */\n    stopPolling() {\n        if (this._pollingIntervalId) {\n            clearInterval(this._pollingIntervalId);\n        }\n    }\n}\n\nexport { OFREPWebProvider };\n","var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// src/hooks/hook-data.ts\nvar MapHookData = class {\n  constructor() {\n    this.data = /* @__PURE__ */ new Map();\n  }\n  set(key, value) {\n    this.data.set(key, value);\n  }\n  get(key) {\n    return this.data.get(key);\n  }\n  has(key) {\n    return this.data.has(key);\n  }\n  delete(key) {\n    return this.data.delete(key);\n  }\n  clear() {\n    this.data.clear();\n  }\n};\n\n// src/evaluation/evaluation.ts\nvar StandardResolutionReasons = {\n  /**\n   * The resolved value is static (no dynamic evaluation).\n   */\n  STATIC: \"STATIC\",\n  /**\n   *  The resolved value was configured statically, or otherwise fell back to a pre-configured value.\n   */\n  DEFAULT: \"DEFAULT\",\n  /**\n   * The resolved value was the result of a dynamic evaluation, such as a rule or specific user-targeting.\n   */\n  TARGETING_MATCH: \"TARGETING_MATCH\",\n  /**\n   * The resolved value was the result of pseudorandom assignment.\n   */\n  SPLIT: \"SPLIT\",\n  /**\n   * The resolved value was retrieved from cache.\n   */\n  CACHED: \"CACHED\",\n  /**\n   * The resolved value was the result of the flag being disabled in the management system.\n   */\n  DISABLED: \"DISABLED\",\n  /**\n   * The reason for the resolved value could not be determined.\n   */\n  UNKNOWN: \"UNKNOWN\",\n  /**\n   * The resolved value is non-authoritative or possibly out of date.\n   */\n  STALE: \"STALE\",\n  /**\n   * The resolved value was the result of an error.\n   *\n   * Note: The `errorCode` and `errorMessage` fields may contain additional details of this error.\n   */\n  ERROR: \"ERROR\"\n};\nvar ErrorCode = /* @__PURE__ */ ((ErrorCode2) => {\n  ErrorCode2[\"PROVIDER_NOT_READY\"] = \"PROVIDER_NOT_READY\";\n  ErrorCode2[\"PROVIDER_FATAL\"] = \"PROVIDER_FATAL\";\n  ErrorCode2[\"FLAG_NOT_FOUND\"] = \"FLAG_NOT_FOUND\";\n  ErrorCode2[\"PARSE_ERROR\"] = \"PARSE_ERROR\";\n  ErrorCode2[\"TYPE_MISMATCH\"] = \"TYPE_MISMATCH\";\n  ErrorCode2[\"TARGETING_KEY_MISSING\"] = \"TARGETING_KEY_MISSING\";\n  ErrorCode2[\"INVALID_CONTEXT\"] = \"INVALID_CONTEXT\";\n  ErrorCode2[\"GENERAL\"] = \"GENERAL\";\n  return ErrorCode2;\n})(ErrorCode || {});\n\n// src/errors/open-feature-error-abstract.ts\nvar OpenFeatureError = class _OpenFeatureError extends Error {\n  constructor(message, options) {\n    super(message);\n    Object.setPrototypeOf(this, _OpenFeatureError.prototype);\n    this.name = \"OpenFeatureError\";\n    this.cause = options == null ? void 0 : options.cause;\n  }\n};\n\n// src/errors/flag-not-found-error.ts\nvar FlagNotFoundError = class _FlagNotFoundError extends OpenFeatureError {\n  constructor(message, options) {\n    super(message, options);\n    Object.setPrototypeOf(this, _FlagNotFoundError.prototype);\n    this.name = \"FlagNotFoundError\";\n    this.code = \"FLAG_NOT_FOUND\" /* FLAG_NOT_FOUND */;\n  }\n};\n\n// src/errors/general-error.ts\nvar GeneralError = class _GeneralError extends OpenFeatureError {\n  constructor(message, options) {\n    super(message, options);\n    Object.setPrototypeOf(this, _GeneralError.prototype);\n    this.name = \"GeneralError\";\n    this.code = \"GENERAL\" /* GENERAL */;\n  }\n};\n\n// src/errors/invalid-context-error.ts\nvar InvalidContextError = class _InvalidContextError extends OpenFeatureError {\n  constructor(message, options) {\n    super(message, options);\n    Object.setPrototypeOf(this, _InvalidContextError.prototype);\n    this.name = \"InvalidContextError\";\n    this.code = \"INVALID_CONTEXT\" /* INVALID_CONTEXT */;\n  }\n};\n\n// src/errors/parse-error.ts\nvar ParseError = class _ParseError extends OpenFeatureError {\n  constructor(message, options) {\n    super(message, options);\n    Object.setPrototypeOf(this, _ParseError.prototype);\n    this.name = \"ParseError\";\n    this.code = \"PARSE_ERROR\" /* PARSE_ERROR */;\n  }\n};\n\n// src/errors/provider-fatal-error.ts\nvar ProviderFatalError = class _ProviderFatalError extends OpenFeatureError {\n  constructor(message, options) {\n    super(message, options);\n    Object.setPrototypeOf(this, _ProviderFatalError.prototype);\n    this.name = \"ProviderFatalError\";\n    this.code = \"PROVIDER_FATAL\" /* PROVIDER_FATAL */;\n  }\n};\n\n// src/errors/provider-not-ready-error.ts\nvar ProviderNotReadyError = class _ProviderNotReadyError extends OpenFeatureError {\n  constructor(message, options) {\n    super(message, options);\n    Object.setPrototypeOf(this, _ProviderNotReadyError.prototype);\n    this.name = \"ProviderNotReadyError\";\n    this.code = \"PROVIDER_NOT_READY\" /* PROVIDER_NOT_READY */;\n  }\n};\n\n// src/errors/targeting-key-missing-error.ts\nvar TargetingKeyMissingError = class _TargetingKeyMissingError extends OpenFeatureError {\n  constructor(message, options) {\n    super(message, options);\n    Object.setPrototypeOf(this, _TargetingKeyMissingError.prototype);\n    this.name = \"TargetingKeyMissingError\";\n    this.code = \"TARGETING_KEY_MISSING\" /* TARGETING_KEY_MISSING */;\n  }\n};\n\n// src/errors/type-mismatch-error.ts\nvar TypeMismatchError = class _TypeMismatchError extends OpenFeatureError {\n  constructor(message, options) {\n    super(message, options);\n    Object.setPrototypeOf(this, _TypeMismatchError.prototype);\n    this.name = \"TypeMismatchError\";\n    this.code = \"TYPE_MISMATCH\" /* TYPE_MISMATCH */;\n  }\n};\n\n// src/errors/index.ts\nvar instantiateErrorByErrorCode = (errorCode, message) => {\n  switch (errorCode) {\n    case \"FLAG_NOT_FOUND\" /* FLAG_NOT_FOUND */:\n      return new FlagNotFoundError(message);\n    case \"PARSE_ERROR\" /* PARSE_ERROR */:\n      return new ParseError(message);\n    case \"TYPE_MISMATCH\" /* TYPE_MISMATCH */:\n      return new TypeMismatchError(message);\n    case \"TARGETING_KEY_MISSING\" /* TARGETING_KEY_MISSING */:\n      return new TargetingKeyMissingError(message);\n    case \"INVALID_CONTEXT\" /* INVALID_CONTEXT */:\n      return new InvalidContextError(message);\n    case \"PROVIDER_NOT_READY\" /* PROVIDER_NOT_READY */:\n      return new ProviderNotReadyError(message);\n    case \"PROVIDER_FATAL\" /* PROVIDER_FATAL */:\n      return new ProviderFatalError(message);\n    default:\n      return new GeneralError(message);\n  }\n};\n\n// src/provider/provider.ts\nvar ServerProviderStatus = /* @__PURE__ */ ((ServerProviderStatus2) => {\n  ServerProviderStatus2[\"NOT_READY\"] = \"NOT_READY\";\n  ServerProviderStatus2[\"READY\"] = \"READY\";\n  ServerProviderStatus2[\"ERROR\"] = \"ERROR\";\n  ServerProviderStatus2[\"STALE\"] = \"STALE\";\n  ServerProviderStatus2[\"FATAL\"] = \"FATAL\";\n  return ServerProviderStatus2;\n})(ServerProviderStatus || {});\nvar ClientProviderStatus = /* @__PURE__ */ ((ClientProviderStatus2) => {\n  ClientProviderStatus2[\"NOT_READY\"] = \"NOT_READY\";\n  ClientProviderStatus2[\"READY\"] = \"READY\";\n  ClientProviderStatus2[\"ERROR\"] = \"ERROR\";\n  ClientProviderStatus2[\"STALE\"] = \"STALE\";\n  ClientProviderStatus2[\"FATAL\"] = \"FATAL\";\n  ClientProviderStatus2[\"RECONCILING\"] = \"RECONCILING\";\n  return ClientProviderStatus2;\n})(ClientProviderStatus || {});\n\n// src/events/events.ts\nvar ServerProviderEvents = /* @__PURE__ */ ((ServerProviderEvents2) => {\n  ServerProviderEvents2[\"Ready\"] = \"PROVIDER_READY\";\n  ServerProviderEvents2[\"Error\"] = \"PROVIDER_ERROR\";\n  ServerProviderEvents2[\"ConfigurationChanged\"] = \"PROVIDER_CONFIGURATION_CHANGED\";\n  ServerProviderEvents2[\"Stale\"] = \"PROVIDER_STALE\";\n  return ServerProviderEvents2;\n})(ServerProviderEvents || {});\nvar ClientProviderEvents = /* @__PURE__ */ ((ClientProviderEvents2) => {\n  ClientProviderEvents2[\"Ready\"] = \"PROVIDER_READY\";\n  ClientProviderEvents2[\"Error\"] = \"PROVIDER_ERROR\";\n  ClientProviderEvents2[\"ConfigurationChanged\"] = \"PROVIDER_CONFIGURATION_CHANGED\";\n  ClientProviderEvents2[\"ContextChanged\"] = \"PROVIDER_CONTEXT_CHANGED\";\n  ClientProviderEvents2[\"Reconciling\"] = \"PROVIDER_RECONCILING\";\n  ClientProviderEvents2[\"Stale\"] = \"PROVIDER_STALE\";\n  return ClientProviderEvents2;\n})(ClientProviderEvents || {});\n\n// src/events/event-utils.ts\nvar eventStatusMap = {\n  [\"READY\" /* READY */]: \"PROVIDER_READY\" /* Ready */,\n  [\"ERROR\" /* ERROR */]: \"PROVIDER_ERROR\" /* Error */,\n  [\"FATAL\" /* FATAL */]: \"PROVIDER_ERROR\" /* Error */,\n  [\"STALE\" /* STALE */]: \"PROVIDER_STALE\" /* Stale */,\n  [\"RECONCILING\" /* RECONCILING */]: \"PROVIDER_RECONCILING\" /* Reconciling */,\n  [\"NOT_READY\" /* NOT_READY */]: void 0\n};\nvar statusMatchesEvent = (event, status) => {\n  return !status && event === \"PROVIDER_READY\" /* Ready */ || eventStatusMap[status] === event;\n};\n\n// src/logger/default-logger.ts\nvar DefaultLogger = class {\n  error(...args) {\n    console.error(...args);\n  }\n  warn(...args) {\n    console.warn(...args);\n  }\n  info() {\n  }\n  debug() {\n  }\n};\n\n// src/logger/safe-logger.ts\nvar LOG_LEVELS = [\"error\", \"warn\", \"info\", \"debug\"];\nvar SafeLogger = class {\n  constructor(logger) {\n    this.fallbackLogger = new DefaultLogger();\n    try {\n      for (const level of LOG_LEVELS) {\n        if (!logger[level] || typeof logger[level] !== \"function\") {\n          throw new Error(`The provided logger is missing the ${level} method.`);\n        }\n      }\n      this.logger = logger;\n    } catch (err) {\n      console.error(err);\n      console.error(\"Falling back to the default logger.\");\n      this.logger = this.fallbackLogger;\n    }\n  }\n  error(...args) {\n    this.log(\"error\", ...args);\n  }\n  warn(...args) {\n    this.log(\"warn\", ...args);\n  }\n  info(...args) {\n    this.log(\"info\", ...args);\n  }\n  debug(...args) {\n    this.log(\"debug\", ...args);\n  }\n  log(level, ...args) {\n    try {\n      this.logger[level](...args);\n    } catch (error) {\n      this.fallbackLogger[level](...args);\n    }\n  }\n};\n\n// src/events/generic-event-emitter.ts\nvar GenericEventEmitter = class {\n  constructor(globalLogger) {\n    this.globalLogger = globalLogger;\n    this._handlers = {\n      [\"PROVIDER_CONFIGURATION_CHANGED\" /* ConfigurationChanged */]: /* @__PURE__ */ new WeakMap(),\n      [\"PROVIDER_CONTEXT_CHANGED\" /* ContextChanged */]: /* @__PURE__ */ new WeakMap(),\n      [\"PROVIDER_READY\" /* Ready */]: /* @__PURE__ */ new WeakMap(),\n      [\"PROVIDER_ERROR\" /* Error */]: /* @__PURE__ */ new WeakMap(),\n      [\"PROVIDER_STALE\" /* Stale */]: /* @__PURE__ */ new WeakMap(),\n      [\"PROVIDER_RECONCILING\" /* Reconciling */]: /* @__PURE__ */ new WeakMap()\n    };\n  }\n  // here we use E, to restrict the events a provider can manually emit (PROVIDER_CONTEXT_CHANGED is emitted by the SDK)\n  emit(eventType, context) {\n    this.eventEmitter.emit(eventType, context);\n  }\n  addHandler(eventType, handler) {\n    const asyncHandler = (details) => __async(this, null, function* () {\n      var _a;\n      try {\n        yield handler(details);\n      } catch (err) {\n        (_a = this._logger) == null ? void 0 : _a.error(\"Error running event handler:\", err);\n      }\n    });\n    const existingAsyncHandlers = this._handlers[eventType].get(handler);\n    this._handlers[eventType].set(handler, [...existingAsyncHandlers || [], asyncHandler]);\n    this.eventEmitter.on(eventType, asyncHandler);\n  }\n  removeHandler(eventType, handler) {\n    const existingAsyncHandlers = this._handlers[eventType].get(handler);\n    if (existingAsyncHandlers) {\n      const removedAsyncHandler = existingAsyncHandlers.pop();\n      if (removedAsyncHandler) {\n        this.eventEmitter.removeListener(eventType, removedAsyncHandler);\n      }\n    }\n  }\n  removeAllHandlers(eventType) {\n    if (eventType) {\n      this.eventEmitter.removeAllListeners(eventType);\n    } else {\n      this.eventEmitter.removeAllListeners();\n    }\n  }\n  getHandlers(eventType) {\n    return this.eventEmitter.listeners(eventType);\n  }\n  setLogger(logger) {\n    this._eventLogger = new SafeLogger(logger);\n    return this;\n  }\n  get _logger() {\n    var _a, _b;\n    return (_b = this._eventLogger) != null ? _b : (_a = this.globalLogger) == null ? void 0 : _a.call(this);\n  }\n};\n\n// src/telemetry/attributes.ts\nvar TelemetryAttribute = {\n  /**\n   * The lookup key of the feature flag.\n   *\n   * - type: `string`\n   * - requirement level: `required`\n   * - example: `logo-color`\n   */\n  KEY: \"feature_flag.key\",\n  /**\n   * Describes a class of error the operation ended with.\n   *\n   * - type: `string`\n   * - requirement level: `conditionally required`\n   * - condition: `reason` is `error`\n   * - example: `flag_not_found`\n   */\n  ERROR_CODE: \"error.type\",\n  /**\n   * A message explaining the nature of an error occurring during flag evaluation.\n   *\n   * - type: `string`\n   * - requirement level: `recommended`\n   * - example: `Flag not found`\n   */\n  ERROR_MESSAGE: \"error.message\",\n  /**\n   * A semantic identifier for an evaluated flag value.\n   *\n   * - type: `string`\n   * - requirement level: `conditionally required`\n   * - condition: variant is defined on the evaluation details\n   * - example: `blue`; `on`; `true`\n   */\n  VARIANT: \"feature_flag.result.variant\",\n  /**\n   * The evaluated value of the feature flag.\n   *\n   * - type: `undefined`\n   * - requirement level: `conditionally required`\n   * - example: `#ff0000`; `1`; `true`\n   */\n  VALUE: \"feature_flag.result.value\",\n  /**\n   * The unique identifier for the flag evaluation context. For example, the targeting key.\n   *\n   * - type: `string`\n   * - requirement level: `recommended`\n   * - example: `5157782b-2203-4c80-a857-dbbd5e7761db`\n   */\n  CONTEXT_ID: \"feature_flag.context.id\",\n  /**\n   * The reason code which shows how a feature flag value was determined.\n   *\n   * - type: `string`\n   * - requirement level: `recommended`\n   * - example: `targeting_match`\n   */\n  REASON: \"feature_flag.result.reason\",\n  /**\n   * Describes a class of error the operation ended with.\n   *\n   * - type: `string`\n   * - requirement level: `recommended`\n   * - example: `flag_not_found`\n   */\n  PROVIDER: \"feature_flag.provider.name\",\n  /**\n   * The identifier of the flag set to which the feature flag belongs.\n   *\n   * - type: `string`\n   * - requirement level: `recommended`\n   * - example: `proj-1`; `ab98sgs`; `service1/dev`\n   */\n  FLAG_SET_ID: \"feature_flag.set.id\",\n  /**\n   * The version of the ruleset used during the evaluation. This may be any stable value which uniquely identifies the ruleset.\n   *\n   * - type: `string`\n   * - requirement level: `recommended`\n   * - example: `1.0.0`; `2021-01-01`\n   */\n  VERSION: \"feature_flag.version\"\n};\n\n// src/telemetry/flag-metadata.ts\nvar TelemetryFlagMetadata = {\n  /**\n   * The context identifier returned in the flag metadata uniquely identifies\n   * the subject of the flag evaluation. If not available, the targeting key\n   * should be used.\n   */\n  CONTEXT_ID: \"contextId\",\n  /**\n   * \tA logical identifier for the flag set.\n   */\n  FLAG_SET_ID: \"flagSetId\",\n  /**\n   * \tA version string (format unspecified) for the flag or flag set.\n   */\n  VERSION: \"version\"\n};\n\n// src/telemetry/evaluation-event.ts\nvar FLAG_EVALUATION_EVENT_NAME = \"feature_flag.evaluation\";\nfunction createEvaluationEvent(hookContext, evaluationDetails) {\n  var _a, _b, _c;\n  const attributes = {\n    [TelemetryAttribute.KEY]: hookContext.flagKey,\n    [TelemetryAttribute.PROVIDER]: hookContext.providerMetadata.name,\n    [TelemetryAttribute.REASON]: ((_a = evaluationDetails.reason) != null ? _a : StandardResolutionReasons.UNKNOWN).toLowerCase()\n  };\n  if (evaluationDetails.variant) {\n    attributes[TelemetryAttribute.VARIANT] = evaluationDetails.variant;\n  }\n  if (evaluationDetails.value !== null) {\n    if (typeof evaluationDetails.value !== \"object\") {\n      attributes[TelemetryAttribute.VALUE] = evaluationDetails.value;\n    } else {\n      try {\n        attributes[TelemetryAttribute.VALUE] = JSON.stringify(evaluationDetails.value);\n      } catch (e) {\n      }\n    }\n  }\n  const contextId = (_b = evaluationDetails.flagMetadata[TelemetryFlagMetadata.CONTEXT_ID]) != null ? _b : hookContext.context.targetingKey;\n  if (contextId) {\n    attributes[TelemetryAttribute.CONTEXT_ID] = contextId;\n  }\n  const setId = evaluationDetails.flagMetadata[TelemetryFlagMetadata.FLAG_SET_ID];\n  if (setId) {\n    attributes[TelemetryAttribute.FLAG_SET_ID] = setId;\n  }\n  const version = evaluationDetails.flagMetadata[TelemetryFlagMetadata.VERSION];\n  if (version) {\n    attributes[TelemetryAttribute.VERSION] = version;\n  }\n  if (evaluationDetails.reason === StandardResolutionReasons.ERROR) {\n    attributes[TelemetryAttribute.ERROR_CODE] = ((_c = evaluationDetails.errorCode) != null ? _c : \"GENERAL\" /* GENERAL */).toLowerCase();\n    if (evaluationDetails.errorMessage) {\n      attributes[TelemetryAttribute.ERROR_MESSAGE] = evaluationDetails.errorMessage;\n    }\n  }\n  return {\n    name: FLAG_EVALUATION_EVENT_NAME,\n    attributes\n  };\n}\n\n// src/type-guards.ts\nfunction isString(value) {\n  return typeof value === \"string\";\n}\nfunction stringOrUndefined(value) {\n  return isString(value) ? value : void 0;\n}\nfunction isObject(value) {\n  return typeof value === \"object\";\n}\nfunction objectOrUndefined(value) {\n  return isObject(value) ? value : void 0;\n}\n\n// src/filter.ts\nfunction isDefined(input) {\n  return typeof input !== \"undefined\" && input !== null;\n}\n\n// src/open-feature.ts\nvar ProviderWrapper = class {\n  constructor(_provider, _status, _statusEnumType) {\n    this._provider = _provider;\n    this._status = _status;\n    this._pendingContextChanges = 0;\n    var _a, _b, _c;\n    (_a = _provider.events) == null ? void 0 : _a.addHandler(\"PROVIDER_READY\" /* Ready */, () => {\n      this._status = _statusEnumType.READY;\n    });\n    (_b = _provider.events) == null ? void 0 : _b.addHandler(\"PROVIDER_STALE\" /* Stale */, () => {\n      this._status = _statusEnumType.STALE;\n    });\n    (_c = _provider.events) == null ? void 0 : _c.addHandler(\"PROVIDER_ERROR\" /* Error */, (details) => {\n      if ((details == null ? void 0 : details.errorCode) === \"PROVIDER_FATAL\" /* PROVIDER_FATAL */) {\n        this._status = _statusEnumType.FATAL;\n      } else {\n        this._status = _statusEnumType.ERROR;\n      }\n    });\n  }\n  get provider() {\n    return this._provider;\n  }\n  set provider(provider) {\n    this._provider = provider;\n  }\n  get status() {\n    return this._status;\n  }\n  set status(status) {\n    this._status = status;\n  }\n  get allContextChangesSettled() {\n    return this._pendingContextChanges === 0;\n  }\n  incrementPendingContextChanges() {\n    this._pendingContextChanges++;\n  }\n  decrementPendingContextChanges() {\n    this._pendingContextChanges--;\n  }\n};\nvar OpenFeatureCommonAPI = class {\n  constructor(category) {\n    this._hooks = [];\n    this._context = {};\n    this._logger = new DefaultLogger();\n    this._clientEventHandlers = /* @__PURE__ */ new Map();\n    this._domainScopedContext = /* @__PURE__ */ new Map();\n    this._clientEvents = /* @__PURE__ */ new Map();\n    this._runsOn = category;\n  }\n  addHooks(...hooks) {\n    this._hooks = [...this._hooks, ...hooks];\n    return this;\n  }\n  getHooks() {\n    return this._hooks;\n  }\n  clearHooks() {\n    this._hooks = [];\n    return this;\n  }\n  setLogger(logger) {\n    this._logger = new SafeLogger(logger);\n    return this;\n  }\n  /**\n   * Get metadata about the default provider.\n   * @returns {ProviderMetadata} Provider Metadata\n   */\n  get providerMetadata() {\n    return this.getProviderMetadata();\n  }\n  /**\n   * Get metadata about a registered provider using the client name.\n   * An unbound or empty client name will return metadata from the default provider.\n   * @param {string} domain An identifier which logically binds clients with providers\n   * @returns {ProviderMetadata} Provider Metadata\n   */\n  getProviderMetadata(domain) {\n    return this.getProviderForClient(domain).metadata;\n  }\n  /**\n   * Adds a handler for the given provider event type.\n   * The handlers are called in the order they have been added.\n   * API (global) events run for all providers.\n   * @param {AnyProviderEvent} eventType The provider event type to listen to\n   * @param {EventHandler} handler The handler to run on occurrence of the event type\n   * @param {EventOptions} options Optional options such as signal for aborting\n   */\n  addHandler(eventType, handler, options) {\n    [.../* @__PURE__ */ new Map([[void 0, this._defaultProvider]]), ...this._domainScopedProviders].forEach((keyProviderTuple) => {\n      var _a;\n      const domain = keyProviderTuple[0];\n      const provider = keyProviderTuple[1].provider;\n      const status = keyProviderTuple[1].status;\n      const shouldRunNow = statusMatchesEvent(eventType, status);\n      if (shouldRunNow) {\n        try {\n          handler({ domain, providerName: provider.metadata.name });\n        } catch (err) {\n          (_a = this._logger) == null ? void 0 : _a.error(\"Error running event handler:\", err);\n        }\n      }\n    });\n    this._apiEmitter.addHandler(eventType, handler);\n    if ((options == null ? void 0 : options.signal) && typeof options.signal.addEventListener === \"function\") {\n      options.signal.addEventListener(\"abort\", () => {\n        this.removeHandler(eventType, handler);\n      });\n    }\n  }\n  /**\n   * Removes a handler for the given provider event type.\n   * @param {AnyProviderEvent} eventType The provider event type to remove the listener for\n   * @param {EventHandler} handler The handler to remove for the provider event type\n   */\n  removeHandler(eventType, handler) {\n    this._apiEmitter.removeHandler(eventType, handler);\n  }\n  /**\n   * Removes all event handlers.\n   */\n  clearHandlers() {\n    this._apiEmitter.removeAllHandlers();\n  }\n  /**\n   * Gets the current handlers for the given provider event type.\n   * @param {AnyProviderEvent} eventType The provider event type to get the current handlers for\n   * @returns {EventHandler[]} The handlers currently attached to the given provider event type\n   */\n  getHandlers(eventType) {\n    return this._apiEmitter.getHandlers(eventType);\n  }\n  setAwaitableProvider(domainOrProvider, providerOrUndefined) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    const domain = stringOrUndefined(domainOrProvider);\n    const provider = (_a = objectOrUndefined(domainOrProvider)) != null ? _a : objectOrUndefined(providerOrUndefined);\n    if (!provider) {\n      this._logger.debug(\"No provider defined, ignoring setProvider call\");\n      return;\n    }\n    const oldProvider = this.getProviderForClient(domain);\n    const providerName = provider.metadata.name;\n    if (oldProvider === provider) {\n      this._logger.debug(\"Provider is already set, ignoring setProvider call\");\n      return;\n    }\n    if (!provider.runsOn) {\n      this._logger.debug(`Provider '${provider.metadata.name}' has not defined its intended use.`);\n    } else if (provider.runsOn !== this._runsOn) {\n      throw new GeneralError(`Provider '${provider.metadata.name}' is intended for use on the ${provider.runsOn}.`);\n    }\n    const emitters = this.getAssociatedEventEmitters(domain);\n    let initializationPromise = void 0;\n    const wrappedProvider = new ProviderWrapper(\n      provider,\n      this._statusEnumType.NOT_READY,\n      this._statusEnumType\n    );\n    if (typeof provider.initialize === \"function\" && !this.allProviders.includes(provider)) {\n      initializationPromise = (_e = (_d = (_c = provider.initialize) == null ? void 0 : _c.call(provider, domain ? (_b = this._domainScopedContext.get(domain)) != null ? _b : this._context : this._context)) == null ? void 0 : _d.then(() => {\n        var _a2;\n        wrappedProvider.status = this._statusEnumType.READY;\n        this.getAssociatedEventEmitters(domain).forEach((emitter) => {\n          emitter == null ? void 0 : emitter.emit(\"PROVIDER_READY\" /* Ready */, { clientName: domain, domain, providerName });\n        });\n        (_a2 = this._apiEmitter) == null ? void 0 : _a2.emit(\"PROVIDER_READY\" /* Ready */, { clientName: domain, domain, providerName });\n      })) == null ? void 0 : _e.catch((error) => {\n        var _a2;\n        if ((error == null ? void 0 : error.code) === \"PROVIDER_FATAL\" /* PROVIDER_FATAL */) {\n          wrappedProvider.status = this._statusEnumType.FATAL;\n        } else {\n          wrappedProvider.status = this._statusEnumType.ERROR;\n        }\n        this.getAssociatedEventEmitters(domain).forEach((emitter) => {\n          emitter == null ? void 0 : emitter.emit(\"PROVIDER_ERROR\" /* Error */, {\n            clientName: domain,\n            domain,\n            providerName,\n            message: error == null ? void 0 : error.message\n          });\n        });\n        (_a2 = this._apiEmitter) == null ? void 0 : _a2.emit(\"PROVIDER_ERROR\" /* Error */, {\n          clientName: domain,\n          domain,\n          providerName,\n          message: error == null ? void 0 : error.message\n        });\n        throw error;\n      });\n    } else {\n      wrappedProvider.status = this._statusEnumType.READY;\n      emitters.forEach((emitter) => {\n        emitter == null ? void 0 : emitter.emit(\"PROVIDER_READY\" /* Ready */, { clientName: domain, domain, providerName });\n      });\n      (_f = this._apiEmitter) == null ? void 0 : _f.emit(\"PROVIDER_READY\" /* Ready */, { clientName: domain, domain, providerName });\n    }\n    if (domain) {\n      this._domainScopedProviders.set(domain, wrappedProvider);\n    } else {\n      this._defaultProvider = wrappedProvider;\n    }\n    this.transferListeners(oldProvider, provider, domain, emitters);\n    if (!this.allProviders.includes(oldProvider)) {\n      (_h = (_g = oldProvider == null ? void 0 : oldProvider.onClose) == null ? void 0 : _g.call(oldProvider)) == null ? void 0 : _h.catch((err) => {\n        this._logger.error(`error closing provider: ${err == null ? void 0 : err.message}, ${err == null ? void 0 : err.stack}`);\n      });\n    }\n    return initializationPromise;\n  }\n  getProviderForClient(domain) {\n    var _a, _b;\n    if (!domain) {\n      return this._defaultProvider.provider;\n    }\n    return (_b = (_a = this._domainScopedProviders.get(domain)) == null ? void 0 : _a.provider) != null ? _b : this._defaultProvider.provider;\n  }\n  buildAndCacheEventEmitterForClient(domain) {\n    const emitter = this._clientEvents.get(domain);\n    if (emitter) {\n      return emitter;\n    }\n    const newEmitter = this._createEventEmitter();\n    this._clientEvents.set(domain, newEmitter);\n    const clientProvider = this.getProviderForClient(domain);\n    Object.values(ClientProviderEvents).forEach(\n      (eventType) => {\n        var _a;\n        return (_a = clientProvider.events) == null ? void 0 : _a.addHandler(eventType, (details) => __async(this, null, function* () {\n          newEmitter.emit(eventType, __spreadProps(__spreadValues({}, details), {\n            clientName: domain,\n            domain,\n            providerName: clientProvider.metadata.name\n          }));\n        }));\n      }\n    );\n    return newEmitter;\n  }\n  getUnboundEmitters() {\n    const domainScopedProviders = [...this._domainScopedProviders.keys()];\n    const eventEmitterNames = [...this._clientEvents.keys()].filter(isDefined);\n    const unboundEmitterNames = eventEmitterNames.filter((name) => !domainScopedProviders.includes(name));\n    return [\n      // all unbound, named emitters\n      ...unboundEmitterNames.map((name) => this._clientEvents.get(name)),\n      // the default emitter\n      this._clientEvents.get(void 0)\n    ].filter(isDefined);\n  }\n  getAssociatedEventEmitters(domain) {\n    return domain ? [this.buildAndCacheEventEmitterForClient(domain)] : this.getUnboundEmitters();\n  }\n  transferListeners(oldProvider, newProvider, domain, emitters) {\n    var _a;\n    (_a = this._clientEventHandlers.get(domain)) == null ? void 0 : _a.forEach((eventHandler) => {\n      var _a2;\n      return (_a2 = oldProvider.events) == null ? void 0 : _a2.removeHandler(...eventHandler);\n    });\n    const newClientHandlers = Object.values(ClientProviderEvents).map((eventType) => {\n      const handler = (details) => __async(this, null, function* () {\n        emitters.forEach((emitter) => {\n          emitter == null ? void 0 : emitter.emit(eventType, __spreadProps(__spreadValues({}, details), { clientName: domain, domain, providerName: newProvider.metadata.name }));\n        });\n        this._apiEmitter.emit(eventType, __spreadProps(__spreadValues({}, details), {\n          clientName: domain,\n          domain,\n          providerName: newProvider.metadata.name\n        }));\n      });\n      return [eventType, handler];\n    });\n    this._clientEventHandlers.set(domain, newClientHandlers);\n    newClientHandlers.forEach((eventHandler) => {\n      var _a2;\n      return (_a2 = newProvider.events) == null ? void 0 : _a2.addHandler(...eventHandler);\n    });\n  }\n  close() {\n    return __async(this, null, function* () {\n      var _a, _b;\n      try {\n        yield (_b = (_a = this == null ? void 0 : this._defaultProvider.provider) == null ? void 0 : _a.onClose) == null ? void 0 : _b.call(_a);\n      } catch (err) {\n        this.handleShutdownError(this._defaultProvider.provider, err);\n      }\n      const wrappers = Array.from(this._domainScopedProviders);\n      yield Promise.all(\n        wrappers.map((_0) => __async(this, [_0], function* ([, wrapper]) {\n          var _a2, _b2;\n          try {\n            yield (_b2 = wrapper == null ? void 0 : (_a2 = wrapper.provider).onClose) == null ? void 0 : _b2.call(_a2);\n          } catch (err) {\n            this.handleShutdownError(wrapper == null ? void 0 : wrapper.provider, err);\n          }\n        }))\n      );\n    });\n  }\n  clearProvidersAndSetDefault(defaultProvider) {\n    return __async(this, null, function* () {\n      try {\n        yield this.close();\n      } catch (err) {\n        this._logger.error(\"Unable to cleanly close providers. Resetting to the default configuration.\");\n      } finally {\n        this._domainScopedProviders.clear();\n        this._defaultProvider = new ProviderWrapper(\n          defaultProvider,\n          this._statusEnumType.NOT_READY,\n          this._statusEnumType\n        );\n      }\n    });\n  }\n  get allProviders() {\n    return [\n      ...[...this._domainScopedProviders.values()].map((wrappers) => wrappers.provider),\n      this._defaultProvider.provider\n    ];\n  }\n  handleShutdownError(provider, err) {\n    this._logger.error(`Error during shutdown of provider ${provider.metadata.name}: ${err}`);\n    this._logger.error(err == null ? void 0 : err.stack);\n  }\n};\nexport {\n  ClientProviderEvents as AllProviderEvents,\n  ClientProviderStatus as AllProviderStatus,\n  ClientProviderEvents,\n  ClientProviderStatus,\n  DefaultLogger,\n  ErrorCode,\n  FlagNotFoundError,\n  GeneralError,\n  GenericEventEmitter,\n  InvalidContextError,\n  LOG_LEVELS,\n  MapHookData,\n  OpenFeatureCommonAPI,\n  OpenFeatureError,\n  ParseError,\n  ProviderFatalError,\n  ProviderNotReadyError,\n  ProviderWrapper,\n  SafeLogger,\n  ServerProviderEvents,\n  ServerProviderStatus,\n  StandardResolutionReasons,\n  TargetingKeyMissingError,\n  TelemetryAttribute,\n  TelemetryFlagMetadata,\n  TypeMismatchError,\n  createEvaluationEvent,\n  instantiateErrorByErrorCode,\n  isObject,\n  isString,\n  objectOrUndefined,\n  statusMatchesEvent,\n  stringOrUndefined\n};\n//# sourceMappingURL=index.js.map\n","var __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __reflectGet = Reflect.get;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __commonJS = (cb, mod) => function __require() {\n  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(\n  // If the importer is in node compatibility mode or this is not an ESM\n  // file that has been converted to a CommonJS file using a Babel-\n  // compatible transform (i.e. \"__esModule\" has not been set), then set\n  // \"default\" to the CommonJS \"module.exports\" for node compatibility.\n  isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", { value: mod, enumerable: true }) : target,\n  mod\n));\nvar __superGet = (cls, obj, key) => __reflectGet(__getProtoOf(cls), key, obj);\nvar __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// ../../node_modules/eventemitter3/index.js\nvar require_eventemitter3 = __commonJS({\n  \"../../node_modules/eventemitter3/index.js\"(exports, module) {\n    \"use strict\";\n    var has = Object.prototype.hasOwnProperty;\n    var prefix = \"~\";\n    function Events() {\n    }\n    if (Object.create) {\n      Events.prototype = /* @__PURE__ */ Object.create(null);\n      if (!new Events().__proto__) prefix = false;\n    }\n    function EE(fn, context, once) {\n      this.fn = fn;\n      this.context = context;\n      this.once = once || false;\n    }\n    function addListener(emitter, event, fn, context, once) {\n      if (typeof fn !== \"function\") {\n        throw new TypeError(\"The listener must be a function\");\n      }\n      var listener = new EE(fn, context || emitter, once), evt = prefix ? prefix + event : event;\n      if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n      else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n      else emitter._events[evt] = [emitter._events[evt], listener];\n      return emitter;\n    }\n    function clearEvent(emitter, evt) {\n      if (--emitter._eventsCount === 0) emitter._events = new Events();\n      else delete emitter._events[evt];\n    }\n    function EventEmitter2() {\n      this._events = new Events();\n      this._eventsCount = 0;\n    }\n    EventEmitter2.prototype.eventNames = function eventNames() {\n      var names = [], events, name;\n      if (this._eventsCount === 0) return names;\n      for (name in events = this._events) {\n        if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n      }\n      if (Object.getOwnPropertySymbols) {\n        return names.concat(Object.getOwnPropertySymbols(events));\n      }\n      return names;\n    };\n    EventEmitter2.prototype.listeners = function listeners(event) {\n      var evt = prefix ? prefix + event : event, handlers = this._events[evt];\n      if (!handlers) return [];\n      if (handlers.fn) return [handlers.fn];\n      for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n        ee[i] = handlers[i].fn;\n      }\n      return ee;\n    };\n    EventEmitter2.prototype.listenerCount = function listenerCount(event) {\n      var evt = prefix ? prefix + event : event, listeners = this._events[evt];\n      if (!listeners) return 0;\n      if (listeners.fn) return 1;\n      return listeners.length;\n    };\n    EventEmitter2.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n      var evt = prefix ? prefix + event : event;\n      if (!this._events[evt]) return false;\n      var listeners = this._events[evt], len = arguments.length, args, i;\n      if (listeners.fn) {\n        if (listeners.once) this.removeListener(event, listeners.fn, void 0, true);\n        switch (len) {\n          case 1:\n            return listeners.fn.call(listeners.context), true;\n          case 2:\n            return listeners.fn.call(listeners.context, a1), true;\n          case 3:\n            return listeners.fn.call(listeners.context, a1, a2), true;\n          case 4:\n            return listeners.fn.call(listeners.context, a1, a2, a3), true;\n          case 5:\n            return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n          case 6:\n            return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n        }\n        for (i = 1, args = new Array(len - 1); i < len; i++) {\n          args[i - 1] = arguments[i];\n        }\n        listeners.fn.apply(listeners.context, args);\n      } else {\n        var length = listeners.length, j;\n        for (i = 0; i < length; i++) {\n          if (listeners[i].once) this.removeListener(event, listeners[i].fn, void 0, true);\n          switch (len) {\n            case 1:\n              listeners[i].fn.call(listeners[i].context);\n              break;\n            case 2:\n              listeners[i].fn.call(listeners[i].context, a1);\n              break;\n            case 3:\n              listeners[i].fn.call(listeners[i].context, a1, a2);\n              break;\n            case 4:\n              listeners[i].fn.call(listeners[i].context, a1, a2, a3);\n              break;\n            default:\n              if (!args) for (j = 1, args = new Array(len - 1); j < len; j++) {\n                args[j - 1] = arguments[j];\n              }\n              listeners[i].fn.apply(listeners[i].context, args);\n          }\n        }\n      }\n      return true;\n    };\n    EventEmitter2.prototype.on = function on(event, fn, context) {\n      return addListener(this, event, fn, context, false);\n    };\n    EventEmitter2.prototype.once = function once(event, fn, context) {\n      return addListener(this, event, fn, context, true);\n    };\n    EventEmitter2.prototype.removeListener = function removeListener(event, fn, context, once) {\n      var evt = prefix ? prefix + event : event;\n      if (!this._events[evt]) return this;\n      if (!fn) {\n        clearEvent(this, evt);\n        return this;\n      }\n      var listeners = this._events[evt];\n      if (listeners.fn) {\n        if (listeners.fn === fn && (!once || listeners.once) && (!context || listeners.context === context)) {\n          clearEvent(this, evt);\n        }\n      } else {\n        for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n          if (listeners[i].fn !== fn || once && !listeners[i].once || context && listeners[i].context !== context) {\n            events.push(listeners[i]);\n          }\n        }\n        if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n        else clearEvent(this, evt);\n      }\n      return this;\n    };\n    EventEmitter2.prototype.removeAllListeners = function removeAllListeners(event) {\n      var evt;\n      if (event) {\n        evt = prefix ? prefix + event : event;\n        if (this._events[evt]) clearEvent(this, evt);\n      } else {\n        this._events = new Events();\n        this._eventsCount = 0;\n      }\n      return this;\n    };\n    EventEmitter2.prototype.off = EventEmitter2.prototype.removeListener;\n    EventEmitter2.prototype.addListener = EventEmitter2.prototype.on;\n    EventEmitter2.prefixed = prefix;\n    EventEmitter2.EventEmitter = EventEmitter2;\n    if (\"undefined\" !== typeof module) {\n      module.exports = EventEmitter2;\n    }\n  }\n});\n\n// src/provider/provider.ts\nimport { ClientProviderStatus } from \"@openfeature/core\";\n\n// src/provider/no-op-provider.ts\nvar REASON_NO_OP = \"No-op\";\nvar NoopFeatureProvider = class {\n  constructor() {\n    this.metadata = {\n      name: \"No-op Provider\"\n    };\n  }\n  resolveBooleanEvaluation(_, defaultValue) {\n    return this.noOp(defaultValue);\n  }\n  resolveStringEvaluation(_, defaultValue) {\n    return this.noOp(defaultValue);\n  }\n  resolveNumberEvaluation(_, defaultValue) {\n    return this.noOp(defaultValue);\n  }\n  resolveObjectEvaluation(_, defaultValue) {\n    return this.noOp(defaultValue);\n  }\n  noOp(defaultValue) {\n    return {\n      value: defaultValue,\n      reason: REASON_NO_OP\n    };\n  }\n};\nvar NOOP_PROVIDER = new NoopFeatureProvider();\n\n// src/provider/in-memory-provider/in-memory-provider.ts\nimport {\n  FlagNotFoundError,\n  GeneralError,\n  OpenFeatureError as OpenFeatureError2,\n  StandardResolutionReasons,\n  TypeMismatchError\n} from \"@openfeature/core\";\n\n// src/events/open-feature-event-emitter.ts\nimport { GenericEventEmitter } from \"@openfeature/core\";\n\n// ../../node_modules/eventemitter3/index.mjs\nvar import_index = __toESM(require_eventemitter3(), 1);\n\n// src/events/open-feature-event-emitter.ts\nvar OpenFeatureEventEmitter = class extends GenericEventEmitter {\n  constructor() {\n    super();\n    this.eventEmitter = new import_index.default();\n  }\n};\n\n// src/events/events.ts\nimport { ClientProviderEvents } from \"@openfeature/core\";\n\n// src/provider/in-memory-provider/variant-not-found-error.ts\nimport { ErrorCode, OpenFeatureError } from \"@openfeature/core\";\nvar VariantNotFoundError = class _VariantNotFoundError extends OpenFeatureError {\n  constructor(message) {\n    super(message);\n    Object.setPrototypeOf(this, _VariantNotFoundError.prototype);\n    this.name = \"VariantNotFoundError\";\n    this.code = ErrorCode.GENERAL;\n  }\n};\n\n// src/provider/in-memory-provider/in-memory-provider.ts\nvar InMemoryProvider = class {\n  constructor(flagConfiguration = {}) {\n    this.events = new OpenFeatureEventEmitter();\n    this.runsOn = \"client\";\n    this.metadata = {\n      name: \"in-memory\"\n    };\n    this._flagConfiguration = __spreadValues({}, flagConfiguration);\n  }\n  /**\n   * Overwrites the configured flags.\n   * @param { FlagConfiguration } flagConfiguration new flag configuration\n   */\n  putConfiguration(flagConfiguration) {\n    return __async(this, null, function* () {\n      try {\n        const flagsChanged = Object.entries(__spreadValues(__spreadValues({}, flagConfiguration), this._flagConfiguration)).map(([key]) => key);\n        this._flagConfiguration = __spreadValues({}, flagConfiguration);\n        this.events.emit(ClientProviderEvents.ConfigurationChanged, { flagsChanged });\n      } catch (err) {\n        this.events.emit(ClientProviderEvents.Error);\n        throw err;\n      }\n    });\n  }\n  resolveBooleanEvaluation(flagKey, defaultValue, context, logger) {\n    return this.resolveAndCheckFlag(flagKey, defaultValue, context || this._context, logger);\n  }\n  resolveNumberEvaluation(flagKey, defaultValue, context, logger) {\n    return this.resolveAndCheckFlag(flagKey, defaultValue, context || this._context, logger);\n  }\n  resolveStringEvaluation(flagKey, defaultValue, context, logger) {\n    return this.resolveAndCheckFlag(flagKey, defaultValue, context || this._context, logger);\n  }\n  resolveObjectEvaluation(flagKey, defaultValue, context, logger) {\n    return this.resolveAndCheckFlag(flagKey, defaultValue, context || this._context, logger);\n  }\n  resolveAndCheckFlag(flagKey, defaultValue, context, logger) {\n    if (!(flagKey in this._flagConfiguration)) {\n      const message = `no flag found with key ${flagKey}`;\n      logger == null ? void 0 : logger.debug(message);\n      throw new FlagNotFoundError(message);\n    }\n    if (this._flagConfiguration[flagKey].disabled) {\n      return { value: defaultValue, reason: StandardResolutionReasons.DISABLED };\n    }\n    const resolvedFlag = this.resolveFlagWithReason(flagKey, context);\n    if (resolvedFlag.value === void 0) {\n      const message = `no value associated with variant provided for ${flagKey} found`;\n      logger == null ? void 0 : logger.error(message);\n      throw new VariantNotFoundError(message);\n    }\n    if (typeof resolvedFlag.value != typeof defaultValue) {\n      throw new TypeMismatchError();\n    }\n    return resolvedFlag;\n  }\n  resolveFlagWithReason(flagKey, ctx) {\n    try {\n      const resolutionResult = this.lookupFlagValue(flagKey, ctx);\n      return resolutionResult;\n    } catch (error) {\n      if (!(error instanceof OpenFeatureError2)) {\n        throw new GeneralError((error == null ? void 0 : error.message) || \"unknown error\");\n      }\n      throw error;\n    }\n  }\n  lookupFlagValue(flagKey, ctx) {\n    var _a;\n    const flagSpec = this._flagConfiguration[flagKey];\n    const isContextEval = ctx && (flagSpec == null ? void 0 : flagSpec.contextEvaluator);\n    const variant = isContextEval ? (_a = flagSpec.contextEvaluator) == null ? void 0 : _a.call(flagSpec, ctx) : flagSpec.defaultVariant;\n    const value = variant && (flagSpec == null ? void 0 : flagSpec.variants[variant]);\n    const reason = isContextEval ? StandardResolutionReasons.TARGETING_MATCH : StandardResolutionReasons.STATIC;\n    return __spreadProps(__spreadValues({\n      value\n    }, variant && { variant }), {\n      reason\n    });\n  }\n};\n\n// src/provider/multi-provider/multi-provider-web.ts\nimport { DefaultLogger, GeneralError as GeneralError4, ErrorCode as ErrorCode3, StandardResolutionReasons as StandardResolutionReasons2 } from \"@openfeature/core\";\n\n// src/provider/multi-provider/hook-executor.ts\nvar HookExecutor = class {\n  constructor(logger) {\n    this.logger = logger;\n  }\n  beforeHooks(hooks, hookContext, hints) {\n    var _a;\n    for (const hook of hooks != null ? hooks : []) {\n      (_a = hook == null ? void 0 : hook.before) == null ? void 0 : _a.call(hook, hookContext, Object.freeze(hints));\n    }\n  }\n  afterHooks(hooks, hookContext, evaluationDetails, hints) {\n    var _a;\n    for (const hook of hooks != null ? hooks : []) {\n      (_a = hook == null ? void 0 : hook.after) == null ? void 0 : _a.call(hook, hookContext, evaluationDetails, hints);\n    }\n  }\n  errorHooks(hooks, hookContext, err, hints) {\n    var _a;\n    for (const hook of hooks != null ? hooks : []) {\n      try {\n        (_a = hook == null ? void 0 : hook.error) == null ? void 0 : _a.call(hook, hookContext, err, hints);\n      } catch (err2) {\n        this.logger.error(`Unhandled error during 'error' hook: ${err2}`);\n        if (err2 instanceof Error) {\n          this.logger.error(err2.stack);\n        }\n      }\n    }\n  }\n  finallyHooks(hooks, hookContext, evaluationDetails, hints) {\n    var _a;\n    for (const hook of hooks != null ? hooks : []) {\n      try {\n        (_a = hook == null ? void 0 : hook.finally) == null ? void 0 : _a.call(hook, hookContext, evaluationDetails, hints);\n      } catch (err) {\n        this.logger.error(`Unhandled error during 'finally' hook: ${err}`);\n        if (err instanceof Error) {\n          this.logger.error(err.stack);\n        }\n      }\n    }\n  }\n};\n\n// src/provider/multi-provider/errors.ts\nimport { GeneralError as GeneralError2, OpenFeatureError as OpenFeatureError3 } from \"@openfeature/core\";\nvar ErrorWithCode = class extends OpenFeatureError3 {\n  constructor(code, message) {\n    super(message);\n    this.code = code;\n  }\n};\nvar AggregateError = class extends GeneralError2 {\n  constructor(message, originalErrors) {\n    super(message);\n    this.originalErrors = originalErrors;\n  }\n};\nvar constructAggregateError = (providerErrors) => {\n  const errorsWithSource = providerErrors.map(({ providerName, error }) => {\n    return { source: providerName, error };\n  }).flat();\n  return new AggregateError(\n    `Provider errors occurred: ${errorsWithSource[0].source}: ${errorsWithSource[0].error}`,\n    errorsWithSource\n  );\n};\nvar throwAggregateErrorFromPromiseResults = (result, providerEntries) => {\n  const errors = result.map((r, i) => {\n    if (r.status === \"rejected\") {\n      return { error: r.reason, providerName: providerEntries[i].name };\n    }\n    return null;\n  }).filter((val) => Boolean(val));\n  if (errors.length) {\n    throw constructAggregateError(errors);\n  }\n};\n\n// src/provider/multi-provider/strategies/base-evaluation-strategy.ts\nvar BaseEvaluationStrategy = class {\n  shouldEvaluateThisProvider(strategyContext, _evalContext) {\n    if (strategyContext.providerStatus === ClientProviderStatus.NOT_READY || strategyContext.providerStatus === ClientProviderStatus.FATAL) {\n      return false;\n    }\n    return true;\n  }\n  shouldEvaluateNextProvider(_strategyContext, _context, _result) {\n    return true;\n  }\n  shouldTrackWithThisProvider(strategyContext, _context, _trackingEventName, _trackingEventDetails) {\n    if (strategyContext.providerStatus === ClientProviderStatus.NOT_READY || strategyContext.providerStatus === ClientProviderStatus.FATAL) {\n      return false;\n    }\n    return true;\n  }\n  hasError(resolution) {\n    return \"thrownError\" in resolution || !!resolution.details.errorCode;\n  }\n  hasErrorWithCode(resolution, code) {\n    var _a;\n    return \"thrownError\" in resolution ? ((_a = resolution.thrownError) == null ? void 0 : _a.code) === code : resolution.details.errorCode === code;\n  }\n  collectProviderErrors(resolutions) {\n    var _a;\n    const errors = [];\n    for (const resolution of resolutions) {\n      if (\"thrownError\" in resolution) {\n        errors.push({ providerName: resolution.providerName, error: resolution.thrownError });\n      } else if (resolution.details.errorCode) {\n        errors.push({\n          providerName: resolution.providerName,\n          error: new ErrorWithCode(resolution.details.errorCode, (_a = resolution.details.errorMessage) != null ? _a : \"unknown error\")\n        });\n      }\n    }\n    return { errors };\n  }\n  resolutionToFinalResult(resolution) {\n    return { details: resolution.details, provider: resolution.provider, providerName: resolution.providerName };\n  }\n};\n\n// src/provider/multi-provider/strategies/first-match-strategy.ts\nimport { ErrorCode as ErrorCode2 } from \"@openfeature/core\";\nvar FirstMatchStrategy = class extends BaseEvaluationStrategy {\n  shouldEvaluateNextProvider(strategyContext, context, result) {\n    if (this.hasErrorWithCode(result, ErrorCode2.FLAG_NOT_FOUND)) {\n      return true;\n    }\n    if (this.hasError(result)) {\n      return false;\n    }\n    return false;\n  }\n  determineFinalResult(strategyContext, context, resolutions) {\n    const finalResolution = resolutions[resolutions.length - 1];\n    if (this.hasError(finalResolution)) {\n      return this.collectProviderErrors(resolutions);\n    }\n    return this.resolutionToFinalResult(finalResolution);\n  }\n};\n\n// src/provider/multi-provider/strategies/first-successful-strategy.ts\nvar FirstSuccessfulStrategy = class extends BaseEvaluationStrategy {\n  shouldEvaluateNextProvider(strategyContext, context, result) {\n    return this.hasError(result);\n  }\n  determineFinalResult(strategyContext, context, resolutions) {\n    const finalResolution = resolutions[resolutions.length - 1];\n    if (this.hasError(finalResolution)) {\n      return this.collectProviderErrors(resolutions);\n    }\n    return this.resolutionToFinalResult(finalResolution);\n  }\n};\n\n// src/provider/multi-provider/strategies/comparison-strategy.ts\nimport { GeneralError as GeneralError3 } from \"@openfeature/core\";\nvar ComparisonStrategy = class extends BaseEvaluationStrategy {\n  constructor(fallbackProvider, onMismatch) {\n    super();\n    this.fallbackProvider = fallbackProvider;\n    this.onMismatch = onMismatch;\n  }\n  determineFinalResult(strategyContext, context, resolutions) {\n    var _a;\n    let value;\n    let fallbackResolution;\n    let finalResolution;\n    let mismatch = false;\n    for (const [i, resolution] of resolutions.entries()) {\n      if (this.hasError(resolution)) {\n        return this.collectProviderErrors(resolutions);\n      }\n      if (resolution.provider === this.fallbackProvider) {\n        fallbackResolution = resolution;\n      }\n      if (i === 0) {\n        finalResolution = resolution;\n      }\n      if (typeof value !== \"undefined\" && value !== resolution.details.value) {\n        mismatch = true;\n      } else {\n        value = resolution.details.value;\n      }\n    }\n    if (!fallbackResolution) {\n      throw new GeneralError3(\"Fallback provider not found in resolution results\");\n    }\n    if (!finalResolution) {\n      throw new GeneralError3(\"Final resolution not found in resolution results\");\n    }\n    if (mismatch) {\n      (_a = this.onMismatch) == null ? void 0 : _a.call(this, resolutions);\n      return {\n        details: fallbackResolution.details,\n        provider: fallbackResolution.provider\n      };\n    }\n    return this.resolutionToFinalResult(finalResolution);\n  }\n};\n\n// src/provider/multi-provider/status-tracker.ts\nvar StatusTracker = class {\n  constructor(events) {\n    this.events = events;\n    this.providerStatuses = {};\n  }\n  wrapEventHandler(providerEntry) {\n    var _a, _b, _c, _d, _e;\n    const provider = providerEntry.provider;\n    (_a = provider.events) == null ? void 0 : _a.addHandler(ClientProviderEvents.Error, (details) => {\n      this.changeProviderStatus(providerEntry.name, ClientProviderStatus.ERROR, details);\n    });\n    (_b = provider.events) == null ? void 0 : _b.addHandler(ClientProviderEvents.Stale, (details) => {\n      this.changeProviderStatus(providerEntry.name, ClientProviderStatus.STALE, details);\n    });\n    (_c = provider.events) == null ? void 0 : _c.addHandler(ClientProviderEvents.ConfigurationChanged, (details) => {\n      this.events.emit(ClientProviderEvents.ConfigurationChanged, details);\n    });\n    (_d = provider.events) == null ? void 0 : _d.addHandler(ClientProviderEvents.Ready, (details) => {\n      this.changeProviderStatus(providerEntry.name, ClientProviderStatus.READY, details);\n    });\n    (_e = provider.events) == null ? void 0 : _e.addHandler(ClientProviderEvents.Reconciling, (details) => {\n      this.changeProviderStatus(providerEntry.name, ClientProviderStatus.RECONCILING, details);\n    });\n  }\n  providerStatus(name) {\n    return this.providerStatuses[name];\n  }\n  getStatusFromProviderStatuses() {\n    const statuses = Object.values(this.providerStatuses);\n    if (statuses.includes(ClientProviderStatus.FATAL)) {\n      return ClientProviderStatus.FATAL;\n    } else if (statuses.includes(ClientProviderStatus.NOT_READY)) {\n      return ClientProviderStatus.NOT_READY;\n    } else if (statuses.includes(ClientProviderStatus.ERROR)) {\n      return ClientProviderStatus.ERROR;\n    } else if (statuses.includes(ClientProviderStatus.STALE)) {\n      return ClientProviderStatus.STALE;\n    } else if (statuses.includes(ClientProviderStatus.RECONCILING)) {\n      return ClientProviderStatus.RECONCILING;\n    }\n    return ClientProviderStatus.READY;\n  }\n  changeProviderStatus(name, status, details) {\n    const currentStatus = this.getStatusFromProviderStatuses();\n    this.providerStatuses[name] = status;\n    const newStatus = this.getStatusFromProviderStatuses();\n    if (currentStatus !== newStatus) {\n      if (newStatus === ClientProviderStatus.FATAL || newStatus === ClientProviderStatus.ERROR) {\n        this.events.emit(ClientProviderEvents.Error, details);\n      } else if (newStatus === ClientProviderStatus.STALE) {\n        this.events.emit(ClientProviderEvents.Stale, details);\n      } else if (newStatus === ClientProviderStatus.READY) {\n        this.events.emit(ClientProviderEvents.Ready, details);\n      } else if (newStatus === ClientProviderStatus.RECONCILING) {\n        this.events.emit(ClientProviderEvents.Reconciling, details);\n      }\n    }\n  }\n};\n\n// src/provider/multi-provider/multi-provider-web.ts\nvar MultiProvider = class _MultiProvider {\n  constructor(constructorProviders, evaluationStrategy = new FirstMatchStrategy(), logger = new DefaultLogger()) {\n    this.constructorProviders = constructorProviders;\n    this.evaluationStrategy = evaluationStrategy;\n    this.logger = logger;\n    this.runsOn = \"client\";\n    this.events = new OpenFeatureEventEmitter();\n    this.hookContexts = /* @__PURE__ */ new WeakMap();\n    this.hookHints = /* @__PURE__ */ new WeakMap();\n    this.providerEntries = [];\n    this.providerEntriesByName = {};\n    this.statusTracker = new StatusTracker(this.events);\n    this.hookExecutor = new HookExecutor(this.logger);\n    this.registerProviders(constructorProviders);\n    const aggregateMetadata = Object.keys(this.providerEntriesByName).reduce((acc, name) => {\n      return __spreadProps(__spreadValues({}, acc), { [name]: this.providerEntriesByName[name].provider.metadata });\n    }, {});\n    this.metadata = __spreadProps(__spreadValues({}, aggregateMetadata), {\n      name: _MultiProvider.name\n    });\n  }\n  registerProviders(constructorProviders) {\n    var _a, _b;\n    const providersByName = {};\n    for (const constructorProvider of constructorProviders) {\n      const providerName = constructorProvider.provider.metadata.name;\n      const candidateName = (_a = constructorProvider.name) != null ? _a : providerName;\n      if (constructorProvider.name && providersByName[constructorProvider.name]) {\n        throw new Error(\"Provider names must be unique\");\n      }\n      (_b = providersByName[candidateName]) != null ? _b : providersByName[candidateName] = [];\n      providersByName[candidateName].push(constructorProvider.provider);\n    }\n    for (const name of Object.keys(providersByName)) {\n      const useIndexedNames = providersByName[name].length > 1;\n      for (let i = 0; i < providersByName[name].length; i++) {\n        const indexedName = useIndexedNames ? `${name}-${i + 1}` : name;\n        this.providerEntriesByName[indexedName] = { provider: providersByName[name][i], name: indexedName };\n        this.providerEntries.push(this.providerEntriesByName[indexedName]);\n        this.statusTracker.wrapEventHandler(this.providerEntriesByName[indexedName]);\n      }\n    }\n    Object.freeze(this.providerEntries);\n    Object.freeze(this.providerEntriesByName);\n  }\n  initialize(context) {\n    return __async(this, null, function* () {\n      const result = yield Promise.allSettled(\n        this.providerEntries.map((provider) => {\n          var _a, _b;\n          return (_b = (_a = provider.provider).initialize) == null ? void 0 : _b.call(_a, context);\n        })\n      );\n      throwAggregateErrorFromPromiseResults(result, this.providerEntries);\n    });\n  }\n  onClose() {\n    return __async(this, null, function* () {\n      const result = yield Promise.allSettled(this.providerEntries.map((provider) => {\n        var _a, _b;\n        return (_b = (_a = provider.provider).onClose) == null ? void 0 : _b.call(_a);\n      }));\n      throwAggregateErrorFromPromiseResults(result, this.providerEntries);\n    });\n  }\n  onContextChange(oldContext, newContext) {\n    return __async(this, null, function* () {\n      var _a, _b;\n      for (const providerEntry of this.providerEntries) {\n        yield (_b = (_a = providerEntry.provider).onContextChange) == null ? void 0 : _b.call(_a, oldContext, newContext);\n      }\n    });\n  }\n  resolveBooleanEvaluation(flagKey, defaultValue, context) {\n    return this.flagResolutionProxy(flagKey, \"boolean\", defaultValue, context);\n  }\n  resolveStringEvaluation(flagKey, defaultValue, context) {\n    return this.flagResolutionProxy(flagKey, \"string\", defaultValue, context);\n  }\n  resolveNumberEvaluation(flagKey, defaultValue, context) {\n    return this.flagResolutionProxy(flagKey, \"number\", defaultValue, context);\n  }\n  resolveObjectEvaluation(flagKey, defaultValue, context) {\n    return this.flagResolutionProxy(flagKey, \"object\", defaultValue, context);\n  }\n  track(trackingEventName, context, trackingEventDetails) {\n    var _a, _b;\n    for (const providerEntry of this.providerEntries) {\n      if (!providerEntry.provider.track) {\n        continue;\n      }\n      const strategyContext = {\n        provider: providerEntry.provider,\n        providerName: providerEntry.name,\n        providerStatus: this.statusTracker.providerStatus(providerEntry.name)\n      };\n      if (this.evaluationStrategy.shouldTrackWithThisProvider(\n        strategyContext,\n        context,\n        trackingEventName,\n        trackingEventDetails\n      )) {\n        try {\n          (_b = (_a = providerEntry.provider).track) == null ? void 0 : _b.call(_a, trackingEventName, context, trackingEventDetails);\n        } catch (error) {\n          this.logger.error(\n            `Error tracking event \"${trackingEventName}\" with provider \"${providerEntry.name}\":`,\n            error\n          );\n        }\n      }\n    }\n  }\n  flagResolutionProxy(flagKey, flagType, defaultValue, context) {\n    var _a;\n    const hookContext = this.hookContexts.get(context);\n    const hookHints = this.hookHints.get(context);\n    if (!hookContext || !hookHints) {\n      throw new GeneralError4(\"Hook context not available for evaluation\");\n    }\n    const results = [];\n    for (const providerEntry of this.providerEntries) {\n      const [shouldEvaluateNext, result] = this.evaluateProviderEntry(\n        flagKey,\n        flagType,\n        defaultValue,\n        providerEntry,\n        hookContext,\n        hookHints,\n        context\n      );\n      results.push(result);\n      if (!shouldEvaluateNext) {\n        break;\n      }\n    }\n    const resolutions = results.filter((r) => Boolean(r));\n    const finalResult = this.evaluationStrategy.determineFinalResult({ flagKey, flagType }, context, resolutions);\n    if ((_a = finalResult.errors) == null ? void 0 : _a.length) {\n      throw constructAggregateError(finalResult.errors);\n    }\n    if (!finalResult.details) {\n      throw new GeneralError4(\"No result was returned from any provider\");\n    }\n    return finalResult.details;\n  }\n  evaluateProviderEntry(flagKey, flagType, defaultValue, providerEntry, hookContext, hookHints, context) {\n    let evaluationResult = void 0;\n    const provider = providerEntry.provider;\n    const strategyContext = {\n      flagKey,\n      flagType,\n      provider,\n      providerName: providerEntry.name,\n      providerStatus: this.statusTracker.providerStatus(providerEntry.name)\n    };\n    if (!this.evaluationStrategy.shouldEvaluateThisProvider(strategyContext, context)) {\n      return [true, null];\n    }\n    let resolution;\n    try {\n      evaluationResult = this.evaluateProviderAndHooks(flagKey, defaultValue, provider, hookContext, hookHints);\n      resolution = {\n        details: evaluationResult,\n        provider,\n        providerName: providerEntry.name\n      };\n    } catch (error) {\n      resolution = {\n        thrownError: error,\n        provider,\n        providerName: providerEntry.name\n      };\n    }\n    return [this.evaluationStrategy.shouldEvaluateNextProvider(strategyContext, context, resolution), resolution];\n  }\n  evaluateProviderAndHooks(flagKey, defaultValue, provider, hookContext, hookHints) {\n    var _a;\n    let evaluationDetails;\n    try {\n      this.hookExecutor.beforeHooks(provider.hooks, hookContext, hookHints);\n      const resolutionDetails = this.callProviderResolve(\n        provider,\n        flagKey,\n        defaultValue,\n        hookContext.context\n      );\n      evaluationDetails = __spreadProps(__spreadValues({}, resolutionDetails), {\n        flagMetadata: Object.freeze((_a = resolutionDetails.flagMetadata) != null ? _a : {}),\n        flagKey\n      });\n      this.hookExecutor.afterHooks(provider.hooks, hookContext, evaluationDetails, hookHints);\n    } catch (error) {\n      this.hookExecutor.errorHooks(provider.hooks, hookContext, error, hookHints);\n      evaluationDetails = this.getErrorEvaluationDetails(flagKey, defaultValue, error);\n    }\n    this.hookExecutor.finallyHooks(provider.hooks, hookContext, evaluationDetails, hookHints);\n    return evaluationDetails;\n  }\n  callProviderResolve(provider, flagKey, defaultValue, context) {\n    switch (typeof defaultValue) {\n      case \"string\":\n        return provider.resolveStringEvaluation(flagKey, defaultValue, context, this.logger);\n      case \"number\":\n        return provider.resolveNumberEvaluation(flagKey, defaultValue, context, this.logger);\n      case \"object\":\n        return provider.resolveObjectEvaluation(flagKey, defaultValue, context, this.logger);\n      case \"boolean\":\n        return provider.resolveBooleanEvaluation(flagKey, defaultValue, context, this.logger);\n      default:\n        throw new GeneralError4(\"Invalid flag evaluation type\");\n    }\n  }\n  get hooks() {\n    return [\n      {\n        before: (hookContext, hints) => {\n          this.hookContexts.set(hookContext.context, hookContext);\n          this.hookHints.set(hookContext.context, hints != null ? hints : {});\n          return hookContext.context;\n        }\n      }\n    ];\n  }\n  getErrorEvaluationDetails(flagKey, defaultValue, err, flagMetadata = {}) {\n    const errorMessage = err == null ? void 0 : err.message;\n    const errorCode = (err == null ? void 0 : err.code) || ErrorCode3.GENERAL;\n    return {\n      errorCode,\n      errorMessage,\n      value: defaultValue,\n      reason: StandardResolutionReasons2.ERROR,\n      flagMetadata: Object.freeze(flagMetadata),\n      flagKey\n    };\n  }\n};\n\n// src/open-feature.ts\nimport {\n  OpenFeatureCommonAPI,\n  ProviderWrapper,\n  objectOrUndefined,\n  stringOrUndefined\n} from \"@openfeature/core\";\n\n// src/client/internal/open-feature-client.ts\nimport {\n  ErrorCode as ErrorCode4,\n  ProviderFatalError,\n  ProviderNotReadyError,\n  SafeLogger,\n  StandardResolutionReasons as StandardResolutionReasons3,\n  instantiateErrorByErrorCode,\n  statusMatchesEvent,\n  MapHookData\n} from \"@openfeature/core\";\nvar OpenFeatureClient = class {\n  constructor(providerAccessor, providerStatusAccessor, emitterAccessor, apiContextAccessor, apiHooksAccessor, globalLogger, options) {\n    this.providerAccessor = providerAccessor;\n    this.providerStatusAccessor = providerStatusAccessor;\n    this.emitterAccessor = emitterAccessor;\n    this.apiContextAccessor = apiContextAccessor;\n    this.apiHooksAccessor = apiHooksAccessor;\n    this.globalLogger = globalLogger;\n    this.options = options;\n    this._hooks = [];\n  }\n  get metadata() {\n    var _a, _b;\n    return {\n      // Use domain if name is not provided\n      name: (_a = this.options.domain) != null ? _a : this.options.name,\n      domain: (_b = this.options.domain) != null ? _b : this.options.name,\n      version: this.options.version,\n      providerMetadata: this.providerAccessor().metadata\n    };\n  }\n  get providerStatus() {\n    return this.providerStatusAccessor();\n  }\n  addHandler(eventType, handler, options) {\n    var _a;\n    this.emitterAccessor().addHandler(eventType, handler);\n    const shouldRunNow = statusMatchesEvent(eventType, this.providerStatus);\n    if (shouldRunNow) {\n      try {\n        handler({\n          clientName: this.metadata.name,\n          domain: this.metadata.domain,\n          providerName: this._provider.metadata.name\n        });\n      } catch (err) {\n        (_a = this._logger) == null ? void 0 : _a.error(\"Error running event handler:\", err);\n      }\n    }\n    if ((options == null ? void 0 : options.signal) && typeof options.signal.addEventListener === \"function\") {\n      options.signal.addEventListener(\"abort\", () => {\n        this.removeHandler(eventType, handler);\n      });\n    }\n  }\n  removeHandler(notificationType, handler) {\n    this.emitterAccessor().removeHandler(notificationType, handler);\n  }\n  getHandlers(eventType) {\n    return this.emitterAccessor().getHandlers(eventType);\n  }\n  setLogger(logger) {\n    this._clientLogger = new SafeLogger(logger);\n    return this;\n  }\n  addHooks(...hooks) {\n    this._hooks = [...this._hooks, ...hooks];\n    return this;\n  }\n  getHooks() {\n    return this._hooks;\n  }\n  clearHooks() {\n    this._hooks = [];\n    return this;\n  }\n  getBooleanValue(flagKey, defaultValue, options) {\n    return this.getBooleanDetails(flagKey, defaultValue, options).value;\n  }\n  getBooleanDetails(flagKey, defaultValue, options) {\n    return this.evaluate(flagKey, this._provider.resolveBooleanEvaluation, defaultValue, \"boolean\", options);\n  }\n  getStringValue(flagKey, defaultValue, options) {\n    return this.getStringDetails(flagKey, defaultValue, options).value;\n  }\n  getStringDetails(flagKey, defaultValue, options) {\n    return this.evaluate(\n      flagKey,\n      // this isolates providers from our restricted string generic argument.\n      this._provider.resolveStringEvaluation,\n      defaultValue,\n      \"string\",\n      options\n    );\n  }\n  getNumberValue(flagKey, defaultValue, options) {\n    return this.getNumberDetails(flagKey, defaultValue, options).value;\n  }\n  getNumberDetails(flagKey, defaultValue, options) {\n    return this.evaluate(\n      flagKey,\n      // this isolates providers from our restricted number generic argument.\n      this._provider.resolveNumberEvaluation,\n      defaultValue,\n      \"number\",\n      options\n    );\n  }\n  getObjectValue(flagKey, defaultValue, options) {\n    return this.getObjectDetails(flagKey, defaultValue, options).value;\n  }\n  getObjectDetails(flagKey, defaultValue, options) {\n    return this.evaluate(flagKey, this._provider.resolveObjectEvaluation, defaultValue, \"object\", options);\n  }\n  track(occurrenceKey, occurrenceDetails = {}) {\n    var _a, _b, _c;\n    try {\n      this.shortCircuitIfNotReady();\n      if (typeof this._provider.track === \"function\") {\n        const frozenContext = Object.freeze(__spreadValues({}, this.apiContextAccessor((_a = this == null ? void 0 : this.options) == null ? void 0 : _a.domain)));\n        return (_c = (_b = this._provider).track) == null ? void 0 : _c.call(_b, occurrenceKey, frozenContext, occurrenceDetails);\n      } else {\n        this._logger.debug(\"Provider does not support the track function; will no-op.\");\n      }\n    } catch (err) {\n      this._logger.debug(\"Error recording tracking event.\", err);\n    }\n  }\n  evaluate(flagKey, resolver, defaultValue, flagType, options = {}) {\n    var _a, _b;\n    const allHooks = [\n      ...this.apiHooksAccessor(),\n      ...this.getHooks(),\n      ...options.hooks || [],\n      ...this._provider.hooks || []\n    ];\n    const allHooksReversed = [...allHooks].reverse();\n    const context = __spreadValues({}, this.apiContextAccessor((_a = this == null ? void 0 : this.options) == null ? void 0 : _a.domain));\n    const hookContexts = allHooksReversed.map(\n      () => Object.freeze({\n        flagKey,\n        defaultValue,\n        flagValueType: flagType,\n        clientMetadata: this.metadata,\n        providerMetadata: this._provider.metadata,\n        context,\n        logger: this._logger,\n        hookData: new MapHookData()\n      })\n    );\n    let evaluationDetails;\n    try {\n      this.beforeHooks(allHooks, hookContexts, options);\n      this.shortCircuitIfNotReady();\n      const resolution = resolver.call(this._provider, flagKey, defaultValue, context, this._logger);\n      const resolutionDetails = __spreadProps(__spreadValues({}, resolution), {\n        flagMetadata: Object.freeze((_b = resolution.flagMetadata) != null ? _b : {}),\n        flagKey\n      });\n      if (resolutionDetails.errorCode) {\n        const err = instantiateErrorByErrorCode(resolutionDetails.errorCode, resolutionDetails.errorMessage);\n        this.errorHooks(allHooksReversed, hookContexts, err, options);\n        evaluationDetails = this.getErrorEvaluationDetails(flagKey, defaultValue, err, resolutionDetails.flagMetadata);\n      } else {\n        this.afterHooks(allHooksReversed, hookContexts, resolutionDetails, options);\n        evaluationDetails = resolutionDetails;\n      }\n    } catch (err) {\n      this.errorHooks(allHooksReversed, hookContexts, err, options);\n      evaluationDetails = this.getErrorEvaluationDetails(flagKey, defaultValue, err);\n    }\n    this.finallyHooks(allHooksReversed, hookContexts, evaluationDetails, options);\n    return evaluationDetails;\n  }\n  beforeHooks(hooks, hookContexts, options) {\n    var _a;\n    for (const [index, hook] of hooks.entries()) {\n      const hookContextIndex = hooks.length - 1 - index;\n      const hookContext = hookContexts[hookContextIndex];\n      Object.freeze(hookContext);\n      Object.freeze(hookContext.context);\n      (_a = hook == null ? void 0 : hook.before) == null ? void 0 : _a.call(hook, hookContext, Object.freeze(options.hookHints));\n    }\n  }\n  afterHooks(hooks, hookContexts, evaluationDetails, options) {\n    var _a;\n    for (const [index, hook] of hooks.entries()) {\n      const hookContext = hookContexts[index];\n      (_a = hook == null ? void 0 : hook.after) == null ? void 0 : _a.call(hook, hookContext, evaluationDetails, options.hookHints);\n    }\n  }\n  errorHooks(hooks, hookContexts, err, options) {\n    var _a;\n    for (const [index, hook] of hooks.entries()) {\n      try {\n        const hookContext = hookContexts[index];\n        (_a = hook == null ? void 0 : hook.error) == null ? void 0 : _a.call(hook, hookContext, err, options.hookHints);\n      } catch (err2) {\n        this._logger.error(`Unhandled error during 'error' hook: ${err2}`);\n        if (err2 instanceof Error) {\n          this._logger.error(err2.stack);\n        }\n        this._logger.error(err2 == null ? void 0 : err2.stack);\n      }\n    }\n  }\n  finallyHooks(hooks, hookContexts, evaluationDetails, options) {\n    var _a;\n    for (const [index, hook] of hooks.entries()) {\n      try {\n        const hookContext = hookContexts[index];\n        (_a = hook == null ? void 0 : hook.finally) == null ? void 0 : _a.call(hook, hookContext, evaluationDetails, options.hookHints);\n      } catch (err) {\n        this._logger.error(`Unhandled error during 'finally' hook: ${err}`);\n        if (err instanceof Error) {\n          this._logger.error(err.stack);\n        }\n        this._logger.error(err == null ? void 0 : err.stack);\n      }\n    }\n  }\n  get _provider() {\n    return this.providerAccessor();\n  }\n  get _logger() {\n    return this._clientLogger || this.globalLogger();\n  }\n  shortCircuitIfNotReady() {\n    if (this.providerStatus === ClientProviderStatus.NOT_READY) {\n      throw new ProviderNotReadyError(\"provider has not yet initialized\");\n    } else if (this.providerStatus === ClientProviderStatus.FATAL) {\n      throw new ProviderFatalError(\"provider is in an irrecoverable error state\");\n    }\n  }\n  getErrorEvaluationDetails(flagKey, defaultValue, err, flagMetadata = {}) {\n    const errorMessage = err == null ? void 0 : err.message;\n    const errorCode = (err == null ? void 0 : err.code) || ErrorCode4.GENERAL;\n    return {\n      errorCode,\n      errorMessage,\n      value: defaultValue,\n      reason: StandardResolutionReasons3.ERROR,\n      flagMetadata: Object.freeze(flagMetadata),\n      flagKey\n    };\n  }\n};\n\n// src/open-feature.ts\nvar GLOBAL_OPENFEATURE_API_KEY = Symbol.for(\"@openfeature/web-sdk/api\");\nvar _globalThis = globalThis;\nvar OpenFeatureAPI = class _OpenFeatureAPI extends OpenFeatureCommonAPI {\n  constructor() {\n    super(\"client\");\n    this._statusEnumType = ClientProviderStatus;\n    this._apiEmitter = new OpenFeatureEventEmitter();\n    this._defaultProvider = new ProviderWrapper(\n      NOOP_PROVIDER,\n      ClientProviderStatus.NOT_READY,\n      this._statusEnumType\n    );\n    this._domainScopedProviders = /* @__PURE__ */ new Map();\n    this._createEventEmitter = () => new OpenFeatureEventEmitter();\n  }\n  /**\n   * Gets a singleton instance of the OpenFeature API.\n   * @ignore\n   * @returns {OpenFeatureAPI} OpenFeature API\n   */\n  static getInstance() {\n    const globalApi = _globalThis[GLOBAL_OPENFEATURE_API_KEY];\n    if (globalApi) {\n      return globalApi;\n    }\n    const instance = new _OpenFeatureAPI();\n    _globalThis[GLOBAL_OPENFEATURE_API_KEY] = instance;\n    return instance;\n  }\n  getProviderStatus(domain) {\n    var _a, _b;\n    if (!domain) {\n      return this._defaultProvider.status;\n    }\n    return (_b = (_a = this._domainScopedProviders.get(domain)) == null ? void 0 : _a.status) != null ? _b : this._defaultProvider.status;\n  }\n  setProviderAndWait(clientOrProvider, providerContextOrUndefined, contextOrUndefined) {\n    return __async(this, null, function* () {\n      const domain = stringOrUndefined(clientOrProvider);\n      const provider = domain ? objectOrUndefined(providerContextOrUndefined) : objectOrUndefined(clientOrProvider);\n      const context = domain ? objectOrUndefined(contextOrUndefined) : objectOrUndefined(providerContextOrUndefined);\n      if (context) {\n        if (domain) {\n          this._domainScopedContext.set(domain, context);\n        } else {\n          this._context = context;\n        }\n      }\n      yield this.setAwaitableProvider(domain, provider);\n    });\n  }\n  setProvider(domainOrProvider, providerContextOrUndefined, contextOrUndefined) {\n    const domain = stringOrUndefined(domainOrProvider);\n    const provider = domain ? objectOrUndefined(providerContextOrUndefined) : objectOrUndefined(domainOrProvider);\n    const context = domain ? objectOrUndefined(contextOrUndefined) : objectOrUndefined(providerContextOrUndefined);\n    if (context) {\n      if (domain) {\n        this._domainScopedContext.set(domain, context);\n      } else {\n        this._context = context;\n      }\n    }\n    const maybePromise = this.setAwaitableProvider(domain, provider);\n    Promise.resolve(maybePromise).catch((err) => {\n      this._logger.error(\"Error during provider initialization:\", err);\n    });\n    return this;\n  }\n  getProvider(domain) {\n    return this.getProviderForClient(domain);\n  }\n  setContext(domainOrContext, contextOrUndefined) {\n    return __async(this, null, function* () {\n      var _a, _b;\n      const domain = stringOrUndefined(domainOrContext);\n      const context = (_b = (_a = objectOrUndefined(domainOrContext)) != null ? _a : objectOrUndefined(contextOrUndefined)) != null ? _b : {};\n      if (domain) {\n        const wrapper = this._domainScopedProviders.get(domain);\n        if (wrapper) {\n          const oldContext = this.getContext(domain);\n          this._domainScopedContext.set(domain, context);\n          yield this.runProviderContextChangeHandler(domain, wrapper, oldContext, context);\n        } else {\n          this._domainScopedContext.set(domain, context);\n        }\n      } else {\n        const oldContext = this._context;\n        this._context = context;\n        const unboundProviders = Array.from(this._domainScopedProviders.entries()).filter(([domain2]) => !this._domainScopedContext.has(domain2)).reduce((acc, [domain2, wrapper]) => {\n          acc.push({ domain: domain2, wrapper });\n          return acc;\n        }, []);\n        const allDomainRecords = [\n          // add in the default (no domain)\n          { domain: void 0, wrapper: this._defaultProvider },\n          ...unboundProviders\n        ];\n        yield Promise.all(\n          allDomainRecords.map((dm) => this.runProviderContextChangeHandler(dm.domain, dm.wrapper, oldContext, context))\n        );\n      }\n    });\n  }\n  getContext(domainOrUndefined) {\n    const domain = stringOrUndefined(domainOrUndefined);\n    if (domain) {\n      const context = this._domainScopedContext.get(domain);\n      if (context) {\n        return context;\n      } else {\n        this._logger.debug(`Unable to find context for '${domain}'.`);\n      }\n    }\n    return this._context;\n  }\n  clearContext(domainOrUndefined) {\n    return __async(this, null, function* () {\n      const domain = stringOrUndefined(domainOrUndefined);\n      if (domain) {\n        const wrapper = this._domainScopedProviders.get(domain);\n        if (wrapper) {\n          const oldContext = this.getContext(domain);\n          this._domainScopedContext.delete(domain);\n          const newContext = this.getContext();\n          yield this.runProviderContextChangeHandler(domain, wrapper, oldContext, newContext);\n        } else {\n          this._domainScopedContext.delete(domain);\n        }\n      } else {\n        return this.setContext({});\n      }\n    });\n  }\n  /**\n   * Resets the global evaluation context and removes the evaluation context for\n   * all domains.\n   */\n  clearContexts() {\n    return __async(this, null, function* () {\n      yield this.clearContext();\n      yield Promise.allSettled(Array.from(this._domainScopedProviders.keys()).map((domain) => this.clearContext(domain)));\n    });\n  }\n  /**\n   * A factory function for creating new domain-scoped OpenFeature clients. Clients\n   * can contain their own state (e.g. logger, hook, context). Multiple domains\n   * can be used to segment feature flag configuration.\n   *\n   * If there is already a provider bound to this name via {@link this.setProvider setProvider}, this provider will be used.\n   * Otherwise, the default provider is used until a provider is assigned to that name.\n   * @param {string} domain An identifier which logically binds clients with providers\n   * @param {string} version The version of the client (only used for metadata)\n   * @returns {Client} OpenFeature Client\n   */\n  getClient(domain, version) {\n    return new OpenFeatureClient(\n      // functions are passed here to make sure that these values are always up to date,\n      // and so we don't have to make these public properties on the API class.\n      () => this.getProviderForClient(domain),\n      () => this.getProviderStatus(domain),\n      () => this.buildAndCacheEventEmitterForClient(domain),\n      (domain2) => this.getContext(domain2),\n      () => this.getHooks(),\n      () => this._logger,\n      { domain, version }\n    );\n  }\n  /**\n   * Clears all registered providers and resets the default provider.\n   * @returns {Promise<void>}\n   */\n  clearProviders() {\n    return __async(this, null, function* () {\n      yield __superGet(_OpenFeatureAPI.prototype, this, \"clearProvidersAndSetDefault\").call(this, NOOP_PROVIDER);\n      this._domainScopedContext.clear();\n    });\n  }\n  runProviderContextChangeHandler(domain, wrapper, oldContext, newContext) {\n    return __async(this, null, function* () {\n      var _a, _b, _c, _d, _e, _f;\n      const providerName = ((_b = (_a = wrapper.provider) == null ? void 0 : _a.metadata) == null ? void 0 : _b.name) || \"unnamed-provider\";\n      try {\n        if (typeof wrapper.provider.onContextChange === \"function\") {\n          const maybePromise = wrapper.provider.onContextChange(oldContext, newContext);\n          if (maybePromise && typeof (maybePromise == null ? void 0 : maybePromise.then) === \"function\") {\n            wrapper.incrementPendingContextChanges();\n            wrapper.status = this._statusEnumType.RECONCILING;\n            this.getAssociatedEventEmitters(domain).forEach((emitter) => {\n              emitter == null ? void 0 : emitter.emit(ClientProviderEvents.Reconciling, { domain, providerName });\n            });\n            (_c = this._apiEmitter) == null ? void 0 : _c.emit(ClientProviderEvents.Reconciling, { domain, providerName });\n            yield maybePromise;\n            wrapper.decrementPendingContextChanges();\n          }\n        }\n        wrapper.status = this._statusEnumType.READY;\n        if (wrapper.allContextChangesSettled) {\n          this.getAssociatedEventEmitters(domain).forEach((emitter) => {\n            emitter == null ? void 0 : emitter.emit(ClientProviderEvents.ContextChanged, { clientName: domain, domain, providerName });\n          });\n          (_d = this._apiEmitter) == null ? void 0 : _d.emit(ClientProviderEvents.ContextChanged, { clientName: domain, domain, providerName });\n        }\n      } catch (err) {\n        wrapper.decrementPendingContextChanges();\n        wrapper.status = this._statusEnumType.ERROR;\n        if (wrapper.allContextChangesSettled) {\n          const error = err;\n          const message = `Error running ${providerName}'s context change handler: ${error == null ? void 0 : error.message}`;\n          (_e = this._logger) == null ? void 0 : _e.error(`${message}`, err);\n          this.getAssociatedEventEmitters(domain).forEach((emitter) => {\n            emitter == null ? void 0 : emitter.emit(ClientProviderEvents.Error, { clientName: domain, domain, providerName, message });\n          });\n          (_f = this._apiEmitter) == null ? void 0 : _f.emit(ClientProviderEvents.Error, { clientName: domain, domain, providerName, message });\n        }\n      }\n    });\n  }\n};\nvar OpenFeature = OpenFeatureAPI.getInstance();\n\n// src/index.ts\nexport * from \"@openfeature/core\";\nexport {\n  AggregateError,\n  BaseEvaluationStrategy,\n  ComparisonStrategy,\n  ErrorWithCode,\n  FirstMatchStrategy,\n  FirstSuccessfulStrategy,\n  InMemoryProvider,\n  MultiProvider,\n  NOOP_PROVIDER,\n  OpenFeature,\n  OpenFeatureAPI,\n  OpenFeatureEventEmitter,\n  ClientProviderEvents as ProviderEvents,\n  ClientProviderStatus as ProviderStatus,\n  constructAggregateError,\n  throwAggregateErrorFromPromiseResults\n};\n//# sourceMappingURL=index.js.map\n"],"names":["OFREPApiError","Error","constructor","error","response","message","options","super","this","Object","setPrototypeOf","prototype","name","OFREPApiFetchError","undefined","OFREPApiUnexpectedResponseError","OFREPApiUnauthorizedError","OFREPForbiddenError","OFREPApiTooManyRequestsError","requestTime","Date","retryAfterDate","retryAfterHeader","headers","get","retryAfterSeconds","retrySeconds","Number","parseInt","isFinite","getTime","date","isNaN","valueOf","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","isEvaluationFailureResponse","key","errorCode","SuppressedError","OFREPEvaluationErrorHttpStatuses","OFREPEvaluationSuccessHttpStatuses","buildHeaders","options_1","arguments","etag","_a","Headers","headersFactory","call","ErrorMessageMap","FLAG_NOT_FOUND","GENERAL","INVALID_CONTEXT","PARSE_ERROR","PROVIDER_FATAL","PROVIDER_NOT_READY","TARGETING_KEY_MISSING","TYPE_MISMATCH","OFREPApi","baseOptions","fetchImplementation","globalThis","fetch","bind","window","self","isomorphicFetch","isJsonMime","contentTypeHeader","jsonRegex","test","isOFREFErrorHttpStatus","status","includes","isOFREFSuccessHttpStatus","doFetchRequest","req","timeoutMs","controller","AbortController","setTimeout","abort","DOMException","signal","err","cause","body","json","_b","postEvaluateFlag","flagKey","evaluationRequest","url","baseUrl","query","toString","request","Request","method","JSON","stringify","httpStatus","httpResponse","postBulkEvaluateFlags","requestBody_1","requestBody","isBulkEvaluationSuccessResponse","isBulkEvaluationFailureResponse","toFlagMetadata","metadata","onlyPrimitiveEntries","entries","filter","fromEntries","RegExp","BulkEvaluationStatus","OFREPWebProvider","logger","DEFAULT_POLL_INTERVAL","runsOn","events","_flagCache","_options","_logger","_etag","_ofrepAPI","_pollingInterval","pollInterval","flagCache","assign","initialize","context","_context","_fetchFlags","startPolling","debug","resolveBooleanEvaluation","defaultValue","_resolve","resolveStringEvaluation","resolveNumberEvaluation","resolveObjectEvaluation","onContextChange","oldContext","newContext","_c","now","_retryPollingAfter","emit","Stale","onClose","stopPolling","evalReq","SUCCESS_NO_CHANGES","flags","bulkSuccessResp","Array","isArray","newCache","reduce","currentCache","currentResponse","listUpdatedFlags","_getListUpdatedFlags","_flagSetMetadataCache","SUCCESS_WITH_CHANGES","oldCache","changedKeys","oldKeys","keys","newKeys","indexOf","push","resolved","responseToResolutionDetails","flagMetadata","reason","ERROR","errorMessage","resultOrError","callback","code","errorDetails","handleEvaluationError","variant","DEFAULT","toResolutionDetails","_pollingIntervalId","setInterval","res","ConfigurationChanged","flagsChanged","clearInterval","__defProp","defineProperty","__defProps","defineProperties","__getOwnPropDescs","getOwnPropertyDescriptors","__getOwnPropSymbols","getOwnPropertySymbols","__hasOwnProp","hasOwnProperty","__propIsEnum","propertyIsEnumerable","__defNormalProp","obj","enumerable","configurable","writable","__spreadValues","a","b","prop","__spreadProps","__async","__this","__arguments","throw","x","MapHookData","data","Map","set","has","delete","clear","StandardResolutionReasons","STATIC","TARGETING_MATCH","SPLIT","CACHED","DISABLED","UNKNOWN","STALE","ErrorCode","ErrorCode2","OpenFeatureError","_OpenFeatureError","FlagNotFoundError","_FlagNotFoundError","GeneralError","_GeneralError","InvalidContextError","_InvalidContextError","ParseError","_ParseError","ProviderFatalError","_ProviderFatalError","ProviderNotReadyError","_ProviderNotReadyError","TargetingKeyMissingError","_TargetingKeyMissingError","TypeMismatchError","_TypeMismatchError","instantiateErrorByErrorCode","ClientProviderStatus","ClientProviderStatus2","ClientProviderEvents","ClientProviderEvents2","eventStatusMap","statusMatchesEvent","event","DefaultLogger","args","console","warn","info","LOG_LEVELS","SafeLogger","fallbackLogger","level","log","GenericEventEmitter","globalLogger","_handlers","WeakMap","eventType","eventEmitter","addHandler","handler","asyncHandler","details","existingAsyncHandlers","on","removeHandler","removedAsyncHandler","pop","removeListener","removeAllHandlers","removeAllListeners","getHandlers","listeners","setLogger","_eventLogger","stringOrUndefined","isString","objectOrUndefined","isObject","isDefined","input","ProviderWrapper","_provider","_status","_statusEnumType","_pendingContextChanges","READY","FATAL","provider","allContextChangesSettled","incrementPendingContextChanges","decrementPendingContextChanges","OpenFeatureCommonAPI","category","_hooks","_clientEventHandlers","_domainScopedContext","_clientEvents","_runsOn","addHooks","hooks","getHooks","clearHooks","providerMetadata","getProviderMetadata","domain","getProviderForClient","_defaultProvider","_domainScopedProviders","forEach","keyProviderTuple","providerName","_apiEmitter","addEventListener","clearHandlers","setAwaitableProvider","domainOrProvider","providerOrUndefined","_d","_e","_f","_g","_h","oldProvider","emitters","getAssociatedEventEmitters","initializationPromise","wrappedProvider","NOT_READY","allProviders","emitter","clientName","_a2","catch","transferListeners","stack","buildAndCacheEventEmitterForClient","newEmitter","_createEventEmitter","clientProvider","values","getUnboundEmitters","domainScopedProviders","map","newProvider","eventHandler","newClientHandlers","close","handleShutdownError","wrappers","from","all","_0","wrapper","_b2","clearProvidersAndSetDefault","defaultProvider","cb","mod","__create","create","__getOwnPropDesc","getOwnPropertyDescriptor","__getOwnPropNames","getOwnPropertyNames","__getProtoOf","getPrototypeOf","__reflectGet","Reflect","require_eventemitter3","exports","module","prefix","Events","EE","fn","once","addListener","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter2","__proto__","eventNames","names","slice","concat","handlers","i","l","length","ee","listenerCount","a1","a2","a3","a4","a5","len","j","off","prefixed","EventEmitter","NOOP_PROVIDER","_","noOp","import_index","isNodeMode","target","to","except","desc","__copyProps","__esModule","__toESM","OpenFeatureEventEmitter","default","OpenFeatureClient","providerAccessor","providerStatusAccessor","emitterAccessor","apiContextAccessor","apiHooksAccessor","version","providerStatus","notificationType","_clientLogger","getBooleanValue","getBooleanDetails","evaluate","getStringValue","getStringDetails","getNumberValue","getNumberDetails","getObjectValue","getObjectDetails","track","occurrenceKey","occurrenceDetails","shortCircuitIfNotReady","frozenContext","freeze","resolver","flagType","allHooks","allHooksReversed","reverse","hookContexts","flagValueType","clientMetadata","hookData","evaluationDetails","beforeHooks","resolution","resolutionDetails","errorHooks","getErrorEvaluationDetails","afterHooks","finallyHooks","index","hook","hookContext","before","hookHints","after","err2","finally","GLOBAL_OPENFEATURE_API_KEY","Symbol","for","_globalThis","OpenFeature","_OpenFeatureAPI","getInstance","globalApi","instance","getProviderStatus","setProviderAndWait","clientOrProvider","providerContextOrUndefined","contextOrUndefined","setProvider","maybePromise","getProvider","setContext","domainOrContext","getContext","runProviderContextChangeHandler","unboundProviders","domain2","acc","allDomainRecords","dm","domainOrUndefined","clearContext","clearContexts","allSettled","getClient","clearProviders","cls","RECONCILING","Reconciling","ContextChanged"],"sourceRoot":""}