# ‚öñÔ∏è COPILOT STRICT ENFORCEMENT

**Tipo**: Regras de Aplica√ß√£o e Enforcement  
**Objetivo**: Garantir cumprimento das regras estritas  
**Autoridade**: M√ÅXIMA - Supersede prefer√™ncias tempor√°rias  
**√öltima Atualiza√ß√£o**: 03/02/2026

---

## üéØ Prop√≥sito

Este arquivo define como as regras definidas em `.copilot-strict-rules.md` devem ser aplicadas e monitoradas durante todas as sess√µes de trabalho.

---

## üîí N√≠veis de Enforcement

### N√≠vel 1: BLOQUEIO IMEDIATO ‚õî
**A√ß√µes que devem ser IMPEDIDAS automaticamente**

- ‚ùå Versionar arquivos em `.secrets/`
- ‚ùå Sobrescrever arquivos de sess√£o anteriores sem backup
- ‚ùå Deletar arquivos de documenta√ß√£o sem confirma√ß√£o
- ‚ùå Criar arquivos na raiz sem justificativa

**A√ß√£o**: Bloquear opera√ß√£o + Alertar usu√°rio + Sugerir alternativa

---

### N√≠vel 2: AVISO OBRIGAT√ìRIO ‚ö†Ô∏è
**A√ß√µes que requerem confirma√ß√£o expl√≠cita**

- ‚ö†Ô∏è Modificar estrutura de pastas estabelecida
- ‚ö†Ô∏è Alterar nomenclatura de arquivos importantes
- ‚ö†Ô∏è Executar opera√ß√µes em produ√ß√£o
- ‚ö†Ô∏è Deletar dados coletados

**A√ß√£o**: Pausar + Explicar impacto + Solicitar confirma√ß√£o

---

### N√≠vel 3: VALIDA√á√ÉO RECOMENDADA üí°
**A√ß√µes que devem ser revisadas**

- üí° Criar novos scripts sem documenta√ß√£o
- üí° Modificar c√≥digo existente sem testes
- üí° Adicionar depend√™ncias n√£o documentadas
- üí° Pular etapas do workflow

**A√ß√£o**: Avisar + Sugerir melhorias + Permitir se confirmado

---

## üìã Valida√ß√µes Autom√°ticas

### Valida√ß√£o de In√≠cio de Sess√£o

```python
def validate_session_start(date: str) -> bool:
    """Valida se todos os requisitos de in√≠cio de sess√£o foram atendidos"""
    
    checks = {
        "session_folder": f".docs/sessions/{date}/" exists,
        "session_recovery": f"SESSION_RECOVERY_{date}.md" exists,
        "today_activities": f"TODAY_ACTIVITIES_{date}.md" exists,
        "index_updated": "INDEX.md" contains current date,
        "todo_updated": "TODO.md" contains current date,
        "previous_context": Previous sessions were read
    }
    
    return all(checks.values())
```

**A√ß√£o se falhar**: 
1. Listar checks faltantes
2. Criar arquivos necess√°rios automaticamente
3. Alertar sobre contexto incompleto

---

### Valida√ß√£o de Organiza√ß√£o de Arquivos

```python
def validate_file_organization() -> bool:
    """Valida se arquivos est√£o nas pastas corretas"""
    
    rules = {
        "root_clean": len([f for f in root if not is_allowed(f)]) == 0,
        "scripts_in_scripts": all python files in /scripts/,
        "docs_in_docs": all .md files in /.docs/,
        "data_in_data": all .json/.csv in /data/,
        "reports_in_reports": all reports in /reports/,
        "secrets_not_versioned": .secrets/ in .gitignore
    }
    
    return all(rules.values())
```

**A√ß√£o se falhar**:
1. Listar arquivos fora do lugar
2. Sugerir reorganiza√ß√£o
3. Oferecer migra√ß√£o autom√°tica

---

### Valida√ß√£o de Documenta√ß√£o

```python
def validate_documentation(session_date: str) -> bool:
    """Valida se documenta√ß√£o est√° completa"""
    
    required_docs = [
        f".docs/sessions/{session_date}/SESSION_RECOVERY_{session_date}.md",
        f".docs/sessions/{session_date}/TODAY_ACTIVITIES_{session_date}.md",
        ".docs/INDEX.md",
        ".docs/TODO.md"
    ]
    
    return all(doc.exists() for doc in required_docs)
```

**A√ß√£o se falhar**:
1. Identificar documentos faltantes
2. Criar templates automaticamente
3. Alertar sobre lacunas na documenta√ß√£o

---

## üîÑ Workflow de Enforcement

### 1. PR√â-EXECU√á√ÉO
**Antes de qualquer a√ß√£o significativa**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  A√ß√£o solicitada pelo usu√°rio   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Validar contra regras estritas ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚îú‚îÄ‚îÄ[BLOQUEIO]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Impedir + Sugerir alternativa
              ‚îÇ
              ‚îú‚îÄ‚îÄ[AVISO]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Confirmar com usu√°rio
              ‚îÇ
              ‚îú‚îÄ‚îÄ[RECOMENDA√á√ÉO]‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Avisar + Permitir
              ‚îÇ
              ‚îî‚îÄ‚îÄ[OK]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Executar
```

### 2. DURANTE EXECU√á√ÉO
**Monitoramento cont√≠nuo**

- ‚úÖ Verificar estrutura de pastas a cada cria√ß√£o de arquivo
- ‚úÖ Validar nomenclatura de arquivos criados
- ‚úÖ Monitorar atualiza√ß√£o de documenta√ß√£o
- ‚úÖ Detectar arquivos indesejados na raiz

### 3. P√ìS-EXECU√á√ÉO
**Valida√ß√£o final**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  A√ß√£o executada com sucesso     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Validar estado final           ‚îÇ
‚îÇ  - Arquivos nas pastas corretas ‚îÇ
‚îÇ  - Documenta√ß√£o atualizada      ‚îÇ
‚îÇ  - Raiz limpa                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚îú‚îÄ‚îÄ[Conforme]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ Continuar
              ‚îÇ
              ‚îî‚îÄ‚îÄ[N√£o conforme]‚îÄ‚îÄ‚ñ∫ Corrigir automaticamente
```

---

## üö® Tratamento de Viola√ß√µes

### Viola√ß√£o de N√≠vel 1 (Cr√≠tica)
**Exemplo**: Tentar versionar arquivo em `.secrets/`

**Resposta**:
1. üõë **BLOQUEAR** opera√ß√£o imediatamente
2. üì¢ **ALERTAR** usu√°rio: "CR√çTICO: Tentativa de versionar credenciais"
3. üîß **SUGERIR**: "Mova o arquivo para .secrets/ e adicione ao .gitignore"
4. üìù **DOCUMENTAR** viola√ß√£o em log de sess√£o

---

### Viola√ß√£o de N√≠vel 2 (Alta)
**Exemplo**: Criar arquivo na raiz sem justificativa

**Resposta**:
1. ‚è∏Ô∏è **PAUSAR** opera√ß√£o
2. ‚ùì **QUESTIONAR**: "Por que este arquivo deve estar na raiz?"
3. üí° **SUGERIR**: "Considere mover para /scripts/ ou /data/"
4. ‚úÖ **PERMITIR** se usu√°rio justificar claramente

---

### Viola√ß√£o de N√≠vel 3 (M√©dia)
**Exemplo**: Criar script sem docstring

**Resposta**:
1. ‚ö†Ô∏è **AVISAR**: "Script criado sem documenta√ß√£o"
2. üìö **SUGERIR**: "Adicione docstrings para melhor manutenibilidade"
3. ‚úÖ **PERMITIR** execu√ß√£o
4. üìù **REGISTRAR** como melhoria futura

---

## üìä Relat√≥rio de Conformidade

### M√©tricas de Sess√£o

Ao final de cada sess√£o, gerar relat√≥rio:

```markdown
## Conformidade com Regras Estritas

### Organiza√ß√£o de Arquivos
- ‚úÖ Raiz limpa: SIM
- ‚úÖ Arquivos nas pastas corretas: 100%
- ‚úÖ Nomenclatura padronizada: SIM

### Documenta√ß√£o
- ‚úÖ SESSION_RECOVERY criado: SIM
- ‚úÖ TODAY_ACTIVITIES atualizado: SIM
- ‚úÖ INDEX.md atualizado: SIM
- ‚úÖ TODO.md atualizado: SIM

### Seguran√ßa
- ‚úÖ Credenciais protegidas: SIM
- ‚úÖ .secrets/ n√£o versionado: SIM
- ‚úÖ Dados sens√≠veis sanitizados: SIM

### C√≥digo
- ‚úÖ PEP 8 seguido: SIM
- ‚úÖ Docstrings presentes: SIM
- ‚úÖ Exce√ß√µes tratadas: SIM

### Score de Conformidade: 100%
```

---

## üîß A√ß√µes Corretivas Autom√°ticas

### 1. Reorganiza√ß√£o de Arquivos

Se detectado arquivo na raiz que n√£o deveria estar:

```python
def auto_organize_file(filepath: str) -> str:
    """Move arquivo para pasta apropriada automaticamente"""
    
    if filepath.endswith('.py') and not is_main_script(filepath):
        move_to('/scripts/')
    elif filepath.endswith('.md') and not is_root_doc(filepath):
        move_to('/.docs/')
    elif filepath.endswith(('.json', '.csv')) and not is_artifact(filepath):
        move_to('/data/')
    elif filepath.endswith('.md') and is_report(filepath):
        move_to('/reports/')
    
    return new_path
```

### 2. Cria√ß√£o de Documenta√ß√£o Faltante

Se detectado aus√™ncia de documenta√ß√£o obrigat√≥ria:

```python
def auto_create_missing_docs(session_date: str):
    """Cria documenta√ß√£o faltante automaticamente"""
    
    templates = {
        "SESSION_RECOVERY": create_recovery_template(session_date),
        "TODAY_ACTIVITIES": create_activities_template(session_date),
        "SESSION_REPORT": create_report_template(session_date)
    }
    
    for doc_type, content in templates.items():
        if not exists(doc_path):
            create_file(doc_path, content)
```

### 3. Atualiza√ß√£o de Datas

Se detectado data desatualizada em INDEX.md ou TODO.md:

```python
def auto_update_dates(current_date: str):
    """Atualiza datas em arquivos principais"""
    
    files_to_update = [
        ".docs/INDEX.md",
        ".docs/TODO.md"
    ]
    
    for file in files_to_update:
        update_last_modified_date(file, current_date)
```

---

## ‚öôÔ∏è Configura√ß√£o de Enforcement

### Modo Estrito (Padr√£o)
- ‚úÖ Todas as valida√ß√µes ativadas
- ‚úÖ Bloqueios autom√°ticos aplicados
- ‚úÖ Avisos obrigat√≥rios mostrados
- ‚úÖ Corre√ß√µes autom√°ticas aplicadas

### Modo Permissivo (Excepcional)
- ‚ö†Ô∏è Valida√ß√µes de seguran√ßa mantidas (N√≠vel 1)
- ‚ö†Ô∏è Outros n√≠veis apenas alertam sem bloquear
- ‚ö†Ô∏è Requer justificativa escrita
- ‚ö†Ô∏è Registra todos os desvios

### Modo Auditoria (An√°lise)
- üìä Todas as a√ß√µes registradas
- üìä Viola√ß√µes documentadas
- üìä Relat√≥rios detalhados gerados
- üìä Sem bloqueios, apenas observa√ß√£o

**Modo Atual**: ESTRITO (recomendado para manter qualidade)

---

## üìù Log de Enforcement

Todas as a√ß√µes de enforcement devem ser registradas:

```json
{
  "timestamp": "2026-02-03T10:30:00Z",
  "session": "2026-02-03",
  "action": "file_creation",
  "file": "temp.txt",
  "location": "/root/",
  "rule_violated": "root_organization",
  "severity": "medium",
  "enforcement_action": "warning_issued",
  "user_response": "moved_to_data",
  "resolved": true
}
```

---

## ‚úÖ Checklist de Conformidade

### In√≠cio de Sess√£o
- [ ] Pasta de sess√£o criada
- [ ] SESSION_RECOVERY criado
- [ ] Contexto anterior recuperado
- [ ] Datas atualizadas
- [ ] TODAY_ACTIVITIES criado

### Durante Sess√£o
- [ ] Arquivos nas pastas corretas
- [ ] C√≥digo documentado
- [ ] Raiz limpa
- [ ] Documenta√ß√£o atualizada

### Final de Sess√£o
- [ ] SESSION_REPORT criado
- [ ] TODO.md atualizado
- [ ] Conformidade validada
- [ ] Relat√≥rio de conformidade gerado

---

**ESTE ENFORCEMENT √â AUTOM√ÅTICO E CONT√çNUO**  
**VIOLA√á√ïES S√ÉO TRATADAS IMEDIATAMENTE**  
**CONFORMIDADE √â VALIDADA EM CADA ETAPA**
